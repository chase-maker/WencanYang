<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="杨文灿">
<meta name="dcterms.date" content="2025-02-26">

<title>连续型机器学习模型 – EDA and Machine learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../TCM/二分类机器学习模型.html" rel="next">
<link href="../TCM/线性回归模型.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d6cd83f18f96971d3a315a5da4dc1c48.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../TCM/contents2.html">中医药研究TCM</a></li><li class="breadcrumb-item"><a href="../TCM/连续型机器学习模型.html">连续型机器学习模型</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../Daisy.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/chase-maker" title="Github website tutorial" class="quarto-navigation-tool px-1" aria-label="Github website tutorial"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">个人简介</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">nycflights13数据探索EDA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/contents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">探索航班延误的原因</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/flights.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flights数据集探索</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/weather.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weather数据集探索</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/joined_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">联立两个数据集</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/reweather.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weather数据集重探索</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/linearregression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">线性回归模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">机器学习模型</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">中医药研究TCM</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../TCM/contents2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">天然血管保护剂的理论预测</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../TCM/线性回归模型.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">线性回归模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../TCM/连续型机器学习模型.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">连续型机器学习模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../TCM/二分类机器学习模型.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">二分类机器学习模型</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#载入数据" id="toc-载入数据" class="nav-link active" data-scroll-target="#载入数据">载入数据</a>
  <ul class="collapse">
  <li><a href="#处理自变量中存在的分类变量" id="toc-处理自变量中存在的分类变量" class="nav-link" data-scroll-target="#处理自变量中存在的分类变量">处理自变量中存在的分类变量</a></li>
  <li><a href="#数据分割" id="toc-数据分割" class="nav-link" data-scroll-target="#数据分割">数据分割</a></li>
  <li><a href="#简单线性回归" id="toc-简单线性回归" class="nav-link" data-scroll-target="#简单线性回归">简单线性回归</a></li>
  <li><a href="#训练数据" id="toc-训练数据" class="nav-link" data-scroll-target="#训练数据">训练数据</a></li>
  </ul></li>
  <li><a href="#机器学习模型构建" id="toc-机器学习模型构建" class="nav-link" data-scroll-target="#机器学习模型构建">机器学习模型构建</a>
  <ul class="collapse">
  <li><a href="#梯度提升机gbm" id="toc-梯度提升机gbm" class="nav-link" data-scroll-target="#梯度提升机gbm">梯度提升机GBM</a></li>
  <li><a href="#随机森林random-forest" id="toc-随机森林random-forest" class="nav-link" data-scroll-target="#随机森林random-forest">随机森林Random Forest</a></li>
  <li><a href="#支持向量机svm" id="toc-支持向量机svm" class="nav-link" data-scroll-target="#支持向量机svm">支持向量机SVM</a></li>
  <li><a href="#比较几种方法的预测效果" id="toc-比较几种方法的预测效果" class="nav-link" data-scroll-target="#比较几种方法的预测效果">比较几种方法的预测效果</a></li>
  <li><a href="#均方误差mse" id="toc-均方误差mse" class="nav-link" data-scroll-target="#均方误差mse">均方误差MSE</a></li>
  </ul></li>
  <li><a href="#作图展示结果" id="toc-作图展示结果" class="nav-link" data-scroll-target="#作图展示结果">作图展示结果</a>
  <ul class="collapse">
  <li><a href="#rf" id="toc-rf" class="nav-link" data-scroll-target="#rf">RF</a></li>
  <li><a href="#svm" id="toc-svm" class="nav-link" data-scroll-target="#svm">SVM</a></li>
  <li><a href="#gbm" id="toc-gbm" class="nav-link" data-scroll-target="#gbm">GBM</a></li>
  <li><a href="#所有方法整合比较" id="toc-所有方法整合比较" class="nav-link" data-scroll-target="#所有方法整合比较">所有方法整合比较</a></li>
  </ul></li>
  <li><a href="#预测新值" id="toc-预测新值" class="nav-link" data-scroll-target="#预测新值">预测新值</a>
  <ul class="collapse">
  <li><a href="#预测" id="toc-预测" class="nav-link" data-scroll-target="#预测">预测</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chase-maker/edit/main/TCM/连续型机器学习模型.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chase-maker/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../TCM/contents2.html">中医药研究TCM</a></li><li class="breadcrumb-item"><a href="../TCM/连续型机器学习模型.html">连续型机器学习模型</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">连续型机器学习模型</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>杨文灿 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 26, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
✏️本节导读
</div>
</div>
<div class="callout-body-container callout-body">
<p>本节考虑到由于不同种类的蛋白质作用机制、作用通路差别较大，以及数据之间可能存在非线性关系，于是考虑机器学习模型来提升拟合优度。</p>
<p>分别构建随机森林模型、梯度提升机模型、支持向量机模型，但效果并不理想，拟合优度仅有微弱提升。</p>
</div>
</div>
<section id="载入数据" class="level1">
<h1>载入数据</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> EC50 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"D:</span><span class="sc">\\</span><span class="st">Rstudio</span><span class="sc">\\</span><span class="st">Rmyfile</span><span class="sc">\\</span><span class="st">Traditional Chinese Medicine</span><span class="sc">\\</span><span class="st">ec50.xlsx"</span>,<span class="at">sheet =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="处理自变量中存在的分类变量" class="level2">
<h2 class="anchored" data-anchor-id="处理自变量中存在的分类变量">处理自变量中存在的分类变量</h2>
<p>将分类变量进行独热编码并与原数据合并</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(caret)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> dummy_vars <span class="ot">&lt;-</span> <span class="fu">dummyVars</span>(<span class="sc">~</span> Species, <span class="at">data =</span> EC50)  </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 使用predict函数和dummyVars对象来生成独热编码矩阵  </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> dummy_data <span class="ot">&lt;-</span> <span class="fu">predict</span>(dummy_vars, <span class="at">newdata =</span> EC50) </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> dummy_EC50 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(dummy_data,EC50[,<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="数据分割" class="level2">
<h2 class="anchored" data-anchor-id="数据分割">数据分割</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">1232</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> trainIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(dummy_EC50<span class="sc">$</span>log10ec50,<span class="at">times=</span><span class="dv">1</span>,<span class="at">p=</span><span class="fl">0.8</span>,<span class="at">list=</span><span class="cn">FALSE</span>,<span class="at">groups=</span><span class="fu">min</span>(<span class="dv">10</span>,<span class="fu">length</span>(EC50<span class="sc">$</span>log10ec50)))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Train <span class="ot">&lt;-</span> dummy_EC50[trainIndex,]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Test <span class="ot">&lt;-</span> dummy_EC50[<span class="sc">-</span>trainIndex,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="简单线性回归" class="level2">
<h2 class="anchored" data-anchor-id="简单线性回归">简单线性回归</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(easystats)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model <span class="ot">&lt;-</span> <span class="fu">lm</span>(log10ec50<span class="sc">~</span>.<span class="sc">-</span>ec50,<span class="at">data =</span> dummy_EC50)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ . - ec50, data = dummy_EC50)
   
   Residuals:
        Min       1Q   Median       3Q      Max 
   -3.12757 -0.57544  0.09198  0.71236  3.10667 
   
   Coefficients: (1 not defined because of singularities)
                Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)  5.705250   0.894998   6.375 1.58e-09 ***
   SpeciesALK  -0.215138   0.374173  -0.575  0.56605    
   SpeciesFLA   1.002742   0.382097   2.624  0.00945 ** 
   SpeciesORG  -0.105390   0.450112  -0.234  0.81515    
   SpeciesPHE   0.271202   0.406670   0.667  0.50572    
   SpeciesPPP   0.839988   0.426249   1.971  0.05034 .  
   SpeciesSAP   0.936018   0.409637   2.285  0.02351 *  
   SpeciesSTE   0.387236   0.655961   0.590  0.55573    
   SpeciesTER         NA         NA      NA       NA    
   AKT1        -0.084454   0.149827  -0.564  0.57370    
   PKC         -0.259246   0.179452  -1.445  0.15034    
   PIK3CA       0.206708   0.165903   1.246  0.21445    
   PDE5        -0.295592   0.176336  -1.676  0.09547 .  
   AMPK        -0.005946   0.229171  -0.026  0.97933    
   eNOS        -0.292342   0.144029  -2.030  0.04390 *  
   SIRT1        0.136005   0.187839   0.724  0.47000    
   PDK1        -0.017912   0.148210  -0.121  0.90395    
   PRKG1        0.034131   0.184448   0.185  0.85341    
   APLNR       -0.194230   0.206903  -0.939  0.34915    
   TGR5         0.236086   0.153745   1.536  0.12645    
   EDNRB       -0.032738   0.186231  -0.176  0.86066    
   CYP1A1      -0.063554   0.063699  -0.998  0.31979    
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 1.141 on 175 degrees of freedom
   Multiple R-squared:  0.2625, Adjusted R-squared:  0.1783 
   F-statistic: 3.115 on 20 and 175 DF,  p-value: 2.969e-05</code></pre>
</div>
</div>
<p>最优子集回归</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model_final <span class="ot">&lt;-</span> model<span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select_parameters</span>()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(model_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ SpeciesFLA + SpeciesPPP + SpeciesSAP + 
       PKC + PDE5 + eNOS + TGR5, data = dummy_EC50)
   
   Residuals:
        Min       1Q   Median       3Q      Max 
   -3.01670 -0.60264  0.07386  0.74992  2.94107 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)   5.4385     0.5905   9.211  &lt; 2e-16 ***
   SpeciesFLA    0.8571     0.2315   3.702 0.000281 ***
   SpeciesPPP    0.7651     0.3122   2.451 0.015176 *  
   SpeciesSAP    0.8560     0.3152   2.716 0.007221 ** 
   PKC          -0.1911     0.1274  -1.500 0.135250    
   PDE5         -0.2865     0.1164  -2.462 0.014708 *  
   eNOS         -0.3019     0.1235  -2.444 0.015430 *  
   TGR5          0.2179     0.1191   1.830 0.068822 .  
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 1.12 on 188 degrees of freedom
   Multiple R-squared:  0.2356, Adjusted R-squared:  0.2071 
   F-statistic: 8.277 on 7 and 188 DF,  p-value: 8.554e-09</code></pre>
</div>
</div>
</section>
<section id="训练数据" class="level2">
<h2 class="anchored" data-anchor-id="训练数据">训练数据</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(caret)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#交叉验证</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>,<span class="at">number =</span> <span class="dv">30</span>,<span class="at">repeats =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="机器学习模型构建" class="level1">
<h1>机器学习模型构建</h1>
<p>GBM(梯度提升机)(基于决策树的集成学习算法)的核心思想是通过迭代的方式，逐步优化模型，每一步都尝试减少模型的残差误差，从而逐渐接近最优解。在每一步迭代中，GBM算法通过增加一个新的决策树来进一步优化模型，同时使用梯度下降算法来最小化残差误差。</p>
<p>SVM 支持向量机</p>
<p>RandomForest 随机森林</p>
<section id="梯度提升机gbm" class="level2">
<h2 class="anchored" data-anchor-id="梯度提升机gbm">梯度提升机GBM</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="fl">2024.11</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> gbmfit <span class="ot">&lt;-</span> <span class="fu">train</span>(log10ec50<span class="sc">~</span>.<span class="sc">-</span>ec50,<span class="at">data =</span> Train,<span class="at">method =</span> <span class="st">"gbm"</span>,<span class="at">trControl=</span>fitControl,<span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> gbmfit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Stochastic Gradient Boosting 
   
   160 samples
    22 predictor
   
   No pre-processing
   Resampling: Cross-Validated (30 fold, repeated 3 times) 
   Summary of sample sizes: 154, 156, 155, 156, 154, 154, ... 
   Resampling results across tuning parameters:
   
     interaction.depth  n.trees  RMSE      Rsquared   MAE      
     1                   50      1.133618  0.3638800  0.9001328
     1                  100      1.163915  0.3527667  0.9207122
     1                  150      1.179919  0.3430091  0.9338863
     2                   50      1.153152  0.3295414  0.9128672
     2                  100      1.186039  0.3248243  0.9330707
     2                  150      1.212259  0.3041567  0.9558360
     3                   50      1.168970  0.3279048  0.9264794
     3                  100      1.205238  0.3136124  0.9623404
     3                  150      1.229551  0.3231229  0.9803674
   
   Tuning parameter 'shrinkage' was held constant at a value of 0.1
   
   Tuning parameter 'n.minobsinnode' was held constant at a value of 10
   RMSE was used to select the optimal model using the smallest value.
   The final values used for the model were n.trees = 50, interaction.depth =
    1, shrinkage = 0.1 and n.minobsinnode = 10.</code></pre>
</div>
</div>
</section>
<section id="随机森林random-forest" class="level2">
<h2 class="anchored" data-anchor-id="随机森林random-forest">随机森林Random Forest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(randomForest)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> rffit <span class="ot">&lt;-</span> <span class="fu">train</span>(log10ec50<span class="sc">~</span>.<span class="sc">-</span>ec50,<span class="at">data =</span> Train,<span class="at">method =</span> <span class="st">"rf"</span>,<span class="at">trControl=</span>fitControl,<span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> rffit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Random Forest 
   
   160 samples
    22 predictor
   
   No pre-processing
   Resampling: Cross-Validated (30 fold, repeated 3 times) 
   Summary of sample sizes: 154, 156, 155, 156, 154, 154, ... 
   Resampling results across tuning parameters:
   
     mtry  RMSE      Rsquared   MAE      
      2    1.128893  0.3765522  0.8927256
     11    1.163318  0.3481787  0.9170471
     21    1.178710  0.3250263  0.9296655
   
   RMSE was used to select the optimal model using the smallest value.
   The final value used for the model was mtry = 2.</code></pre>
</div>
</div>
</section>
<section id="支持向量机svm" class="level2">
<h2 class="anchored" data-anchor-id="支持向量机svm">支持向量机SVM</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(kernlab)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tuneGrid1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">C =</span> <span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">sigma =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>)) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="fl">2024.13</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> svmfit <span class="ot">&lt;-</span> <span class="fu">train</span>(log10ec50<span class="sc">~</span>.<span class="sc">-</span>ec50,<span class="at">data =</span> Train,<span class="at">method =</span> <span class="st">"svmRadial"</span>,<span class="at">trControl=</span>fitControl,<span class="at">verbose=</span><span class="cn">FALSE</span>,<span class="at">tuneGrid=</span> tuneGrid1) </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> svmfit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Support Vector Machines with Radial Basis Function Kernel 
   
   160 samples
    22 predictor
   
   No pre-processing
   Resampling: Cross-Validated (30 fold, repeated 3 times) 
   Summary of sample sizes: 154, 156, 155, 156, 154, 154, ... 
   Resampling results across tuning parameters:
   
     C      sigma  RMSE      Rsquared   MAE      
      0.25  0.01   1.114817  0.3290295  0.8840081
      0.25  0.10   1.126874  0.2728372  0.8864627
      0.25  1.00   1.145490  0.2866486  0.9093973
      0.50  0.01   1.106094  0.3250227  0.8731409
      0.50  0.10   1.144269  0.2806425  0.8968490
      0.50  1.00   1.128325  0.2933209  0.8884422
      1.00  0.01   1.108713  0.3299019  0.8727065
      1.00  0.10   1.201813  0.2793701  0.9501702
      1.00  1.00   1.132500  0.3130900  0.8877241
      2.00  0.01   1.125001  0.3081330  0.8877209
      2.00  0.10   1.232938  0.2831844  0.9764720
      2.00  1.00   1.143035  0.3033660  0.8962083
      4.00  0.01   1.156479  0.2866684  0.9166405
      4.00  0.10   1.244790  0.2796459  0.9853496
      4.00  1.00   1.152324  0.2965280  0.9048406
      8.00  0.01   1.168273  0.3080343  0.9274460
      8.00  0.10   1.289098  0.2854485  1.0250625
      8.00  1.00   1.152679  0.2960620  0.9050780
     16.00  0.01   1.199418  0.3120593  0.9577236
     16.00  0.10   1.307431  0.2957023  1.0449073
     16.00  1.00   1.152679  0.2960620  0.9050780
     32.00  0.01   1.265304  0.2974215  1.0119017
     32.00  0.10   1.319630  0.2959489  1.0526886
     32.00  1.00   1.152679  0.2960620  0.9050780
   
   RMSE was used to select the optimal model using the smallest value.
   The final values used for the model were sigma = 0.01 and C = 0.5.</code></pre>
</div>
</div>
</section>
<section id="比较几种方法的预测效果" class="level2">
<h2 class="anchored" data-anchor-id="比较几种方法的预测效果">比较几种方法的预测效果</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="连续型机器学习模型_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="均方误差mse" class="level2">
<h2 class="anchored" data-anchor-id="均方误差mse">均方误差MSE</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> MSE <span class="ot">&lt;-</span> <span class="cf">function</span>(model,Test){</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(model,<span class="at">newdata =</span> Test)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     real <span class="ot">&lt;-</span> Test<span class="sc">$</span>log10ec50</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="co"># 计算MSE</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predict <span class="sc">-</span> real)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">" MSE:"</span>, mse_lm))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     sst <span class="ot">&lt;-</span><span class="fu">sum</span>((real<span class="sc">-</span><span class="fu">mean</span>(real))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     sse <span class="ot">&lt;-</span> <span class="fu">sum</span>((predict<span class="sc">-</span>real)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     rsq <span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>sse<span class="sc">/</span>sst</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"R-square:"</span>, rsq))</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">MSE</span>(rffit,Test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] " MSE: 1.38425553942827"
   [1] "R-square: 0.122646283157883"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">MSE</span>(svmfit,Test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] " MSE: 1.35111843953737"
   [1] "R-square: 0.143648877640301"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">MSE</span>(gbmfit,Test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] " MSE: 1.41067131279206"
   [1] "R-square: 0.10590372639445"</code></pre>
</div>
</div>
</section>
</section>
<section id="作图展示结果" class="level1">
<h1>作图展示结果</h1>
<p>下图展示了三个机器学习模型的预测值与原来真实值之间的差别。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Keshihua <span class="ot">&lt;-</span> <span class="cf">function</span>(model,Test){</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="fu">library</span>(reshape2)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="fu">library</span>(ggplot2)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(model,<span class="at">newdata =</span> Test)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> real <span class="ot">&lt;-</span> Test<span class="sc">$</span>log10ec50</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> Comparation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">predictvalue =</span> predict , <span class="at">realvalue =</span> real,<span class="at">number =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Test)))) <span class="sc">|&gt;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">"number"</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Comparation, <span class="fu">aes</span>(<span class="at">x=</span>number,<span class="at">y =</span> value,<span class="at">color =</span> variable,<span class="at">group=</span>variable))<span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span>variable),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="at">lwd=</span><span class="fl">1.2</span>)<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparation between predict value and real value"</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="fu">print</span>(a)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="rf" class="level3">
<h3 class="anchored" data-anchor-id="rf">RF</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">Keshihua</span>(rffit,Test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="连续型机器学习模型_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="svm" class="level3">
<h3 class="anchored" data-anchor-id="svm">SVM</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">Keshihua</span>(svmfit,Test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="连续型机器学习模型_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gbm" class="level3">
<h3 class="anchored" data-anchor-id="gbm">GBM</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">Keshihua</span>(gbmfit,Test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="连续型机器学习模型_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="所有方法整合比较" class="level3">
<h3 class="anchored" data-anchor-id="所有方法整合比较">所有方法整合比较</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> RF_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(rffit,<span class="at">newdata =</span> Test)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> GBM_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbmfit,<span class="at">newdata =</span> Test)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> SVM_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmfit,<span class="at">newdata =</span> Test)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Comparation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">RealValue =</span> Test<span class="sc">$</span>log10ec50,<span class="at">RandomForest =</span> RF_predict , <span class="at">SVM =</span> SVM_predict,<span class="at">GBM =</span> GBM_predict,<span class="at">number =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(RF_predict)))) <span class="sc">|&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">"number"</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(Comparation, <span class="fu">aes</span>(<span class="at">x=</span>number,<span class="at">y =</span> value,<span class="at">color =</span> variable,<span class="at">group=</span>variable))<span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span>variable),<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="at">lwd=</span><span class="dv">1</span>)<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span> <span class="co"># 去掉X轴刻度标签</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparation between different predict values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="连续型机器学习模型_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="预测新值" class="level1">
<h1>预测新值</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> saponin_predict_all <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"D:</span><span class="sc">\\</span><span class="st">Rstudio</span><span class="sc">\\</span><span class="st">Rmyfile</span><span class="sc">\\</span><span class="st">Traditional Chinese Medicine</span><span class="sc">\\</span><span class="st">NEW_predict.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>GBM</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="fl">2024.11</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> gbmfit <span class="ot">&lt;-</span> <span class="fu">train</span>(log10ec50<span class="sc">~</span>.,<span class="at">data =</span> Train[,<span class="sc">-</span><span class="dv">22</span>],<span class="at">method =</span> <span class="st">"gbm"</span>,<span class="at">trControl=</span>fitControl,<span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> gbmfit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Stochastic Gradient Boosting 
   
   160 samples
    21 predictor
   
   No pre-processing
   Resampling: Cross-Validated (30 fold, repeated 3 times) 
   Summary of sample sizes: 154, 156, 155, 156, 154, 154, ... 
   Resampling results across tuning parameters:
   
     interaction.depth  n.trees  RMSE      Rsquared   MAE      
     1                   50      1.133618  0.3638800  0.9001328
     1                  100      1.163915  0.3527667  0.9207122
     1                  150      1.179919  0.3430091  0.9338863
     2                   50      1.153152  0.3295414  0.9128672
     2                  100      1.186039  0.3248243  0.9330707
     2                  150      1.212259  0.3041567  0.9558360
     3                   50      1.168970  0.3279048  0.9264794
     3                  100      1.205238  0.3136124  0.9623404
     3                  150      1.229551  0.3231229  0.9803674
   
   Tuning parameter 'shrinkage' was held constant at a value of 0.1
   
   Tuning parameter 'n.minobsinnode' was held constant at a value of 10
   RMSE was used to select the optimal model using the smallest value.
   The final values used for the model were n.trees = 50, interaction.depth =
    1, shrinkage = 0.1 and n.minobsinnode = 10.</code></pre>
</div>
</div>
<p>Random Forest</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(randomForest)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> rffit <span class="ot">&lt;-</span> <span class="fu">train</span>(log10ec50<span class="sc">~</span>.,<span class="at">data =</span> Train[,<span class="sc">-</span><span class="dv">22</span>],<span class="at">method =</span> <span class="st">"rf"</span>,<span class="at">trControl=</span>fitControl,<span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> rffit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Random Forest 
   
   160 samples
    21 predictor
   
   No pre-processing
   Resampling: Cross-Validated (30 fold, repeated 3 times) 
   Summary of sample sizes: 154, 156, 155, 156, 154, 154, ... 
   Resampling results across tuning parameters:
   
     mtry  RMSE      Rsquared   MAE      
      2    1.128893  0.3765522  0.8927256
     11    1.163318  0.3481787  0.9170471
     21    1.178710  0.3250263  0.9296655
   
   RMSE was used to select the optimal model using the smallest value.
   The final value used for the model was mtry = 2.</code></pre>
</div>
</div>
<p>SVM</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(kernlab)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> tuneGrid1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">C =</span> <span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">sigma =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>)) </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="fl">2024.13</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> svmfit <span class="ot">&lt;-</span> <span class="fu">train</span>(log10ec50<span class="sc">~</span>.,<span class="at">data =</span> Train[,<span class="sc">-</span><span class="dv">22</span>],<span class="at">method =</span> <span class="st">"svmRadial"</span>,<span class="at">trControl=</span>fitControl,<span class="at">verbose=</span><span class="cn">FALSE</span>,<span class="at">tuneGrid=</span> tuneGrid1) </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> svmfit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Support Vector Machines with Radial Basis Function Kernel 
   
   160 samples
    21 predictor
   
   No pre-processing
   Resampling: Cross-Validated (30 fold, repeated 3 times) 
   Summary of sample sizes: 154, 156, 155, 156, 154, 154, ... 
   Resampling results across tuning parameters:
   
     C      sigma  RMSE      Rsquared   MAE      
      0.25  0.01   1.114817  0.3290295  0.8840081
      0.25  0.10   1.126874  0.2728372  0.8864627
      0.25  1.00   1.145490  0.2866486  0.9093973
      0.50  0.01   1.106094  0.3250227  0.8731409
      0.50  0.10   1.144269  0.2806425  0.8968490
      0.50  1.00   1.128325  0.2933209  0.8884422
      1.00  0.01   1.108713  0.3299019  0.8727065
      1.00  0.10   1.201813  0.2793701  0.9501702
      1.00  1.00   1.132500  0.3130900  0.8877241
      2.00  0.01   1.125001  0.3081330  0.8877209
      2.00  0.10   1.232938  0.2831844  0.9764720
      2.00  1.00   1.143035  0.3033660  0.8962083
      4.00  0.01   1.156479  0.2866684  0.9166405
      4.00  0.10   1.244790  0.2796459  0.9853496
      4.00  1.00   1.152324  0.2965280  0.9048406
      8.00  0.01   1.168273  0.3080343  0.9274460
      8.00  0.10   1.289098  0.2854485  1.0250625
      8.00  1.00   1.152679  0.2960620  0.9050780
     16.00  0.01   1.199418  0.3120593  0.9577236
     16.00  0.10   1.307431  0.2957023  1.0449073
     16.00  1.00   1.152679  0.2960620  0.9050780
     32.00  0.01   1.265304  0.2974215  1.0119017
     32.00  0.10   1.319630  0.2959489  1.0526886
     32.00  1.00   1.152679  0.2960620  0.9050780
   
   RMSE was used to select the optimal model using the smallest value.
   The final values used for the model were sigma = 0.01 and C = 0.5.</code></pre>
</div>
</div>
<section id="预测" class="level2">
<h2 class="anchored" data-anchor-id="预测">预测</h2>
<p>下面显示的表格的最后三列即为三种机器学习方法的预测结果。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> rffit_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(rffit,<span class="at">newdata =</span> saponin_predict_all)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> svmfit_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmfit,<span class="at">newdata =</span> saponin_predict_all)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> gbmfit_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbmfit,<span class="at">newdata =</span> saponin_predict_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> saponin_predict_all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(saponin_predict_all,rffit_predict,svmfit_predict,gbmfit_predict)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> saponin_predict_all <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(saponin_predict_all)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> saponin_predict_all[<span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      SpeciesALK SpeciesFLA SpeciesORG SpeciesPHE SpeciesPPP SpeciesSAP SpeciesSTE
   10          1          0          0          0          0          0          0
      SpeciesTER  AKT1   PKC PIK3CA PDE5  AMPK  eNOS SIRT1  PDK1 PRKG1 APLNR  TGR5
   10          0 5.974 7.517   7.81 9.12 9.372 8.101 9.978 9.131 6.715  7.72 9.659
      EDNRB CYP1A1 rffit_predict svmfit_predict gbmfit_predict
   10  7.67  6.149      1.739291       0.929666        1.52114</code></pre>
</div>
</div>
<p>作图展示预测结果</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Comparation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">randomForest =</span> rffit_predict , <span class="at">SVM =</span> svmfit_predict,<span class="at">GBM =</span> gbmfit_predict,<span class="at">number =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rffit_predict)))) <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">"number"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(Comparation, <span class="fu">aes</span>(<span class="at">x=</span>number,<span class="at">y =</span> value,<span class="at">color =</span> variable,<span class="at">group=</span>variable))<span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span>variable),<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="at">lwd=</span><span class="dv">1</span>)<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span> <span class="co"># 去掉X轴刻度标签</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparation between different predict values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="连续型机器学习模型_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/github\.com\/chase-maker");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../TCM/线性回归模型.html" class="pagination-link" aria-label="线性回归模型">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">线性回归模型</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../TCM/二分类机器学习模型.html" class="pagination-link" aria-label="二分类机器学习模型">
        <span class="nav-page-text">二分类机器学习模型</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© created by Wencan Yang; December 2024</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chase-maker/edit/main/TCM/连续型机器学习模型.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chase-maker/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with ❤️ and [github][quarto].</p>
</div>
  </div>
</footer>




</body></html>