<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="杨文灿">
<meta name="dcterms.date" content="2025-02-26">

<title>线性回归模型 – EDA and Machine learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../TCM/连续型机器学习模型.html" rel="next">
<link href="../TCM/contents2.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d6cd83f18f96971d3a315a5da4dc1c48.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../TCM/contents2.html">中医药研究TCM</a></li><li class="breadcrumb-item"><a href="../TCM/线性回归模型.html">线性回归模型</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../Daisy.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/chase-maker" title="Github website tutorial" class="quarto-navigation-tool px-1" aria-label="Github website tutorial"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">个人简介</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">nycflights13数据探索EDA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/contents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">探索航班延误的原因</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/flights.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flights数据集探索</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/weather.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weather数据集探索</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/joined_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">联立两个数据集</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/reweather.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weather数据集重探索</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/linearregression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">线性回归模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">机器学习模型</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">中医药研究TCM</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../TCM/contents2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">天然血管保护剂的理论预测</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../TCM/线性回归模型.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">线性回归模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../TCM/连续型机器学习模型.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">连续型机器学习模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../TCM/二分类机器学习模型.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">二分类机器学习模型</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#数据导入" id="toc-数据导入" class="nav-link active" data-scroll-target="#数据导入">数据导入</a></li>
  <li><a href="#观测各变量趋势" id="toc-观测各变量趋势" class="nav-link" data-scroll-target="#观测各变量趋势">观测各变量趋势</a>
  <ul class="collapse">
  <li><a href="#以ec50为因变量" id="toc-以ec50为因变量" class="nav-link" data-scroll-target="#以ec50为因变量">以ec50为因变量</a></li>
  <li><a href="#以log10ec50为因变量" id="toc-以log10ec50为因变量" class="nav-link" data-scroll-target="#以log10ec50为因变量">以log10ec50为因变量</a></li>
  <li><a href="#各种化合物类型的结合能差异" id="toc-各种化合物类型的结合能差异" class="nav-link" data-scroll-target="#各种化合物类型的结合能差异">各种化合物类型的结合能差异</a></li>
  </ul></li>
  <li><a href="#对所有指标构建线性模型" id="toc-对所有指标构建线性模型" class="nav-link" data-scroll-target="#对所有指标构建线性模型">对所有指标构建线性模型</a>
  <ul class="collapse">
  <li><a href="#线性模型诊断" id="toc-线性模型诊断" class="nav-link" data-scroll-target="#线性模型诊断">线性模型诊断</a></li>
  <li><a href="#相关性图" id="toc-相关性图" class="nav-link" data-scroll-target="#相关性图">相关性图</a></li>
  <li><a href="#最优子集法筛选模型" id="toc-最优子集法筛选模型" class="nav-link" data-scroll-target="#最优子集法筛选模型">最优子集法筛选模型</a></li>
  </ul></li>
  <li><a href="#岭回归" id="toc-岭回归" class="nav-link" data-scroll-target="#岭回归">岭回归</a>
  <ul class="collapse">
  <li><a href="#计算岭系数" id="toc-计算岭系数" class="nav-link" data-scroll-target="#计算岭系数">计算岭系数</a>
  <ul class="collapse">
  <li><a href="#方法1-交叉验证" id="toc-方法1-交叉验证" class="nav-link" data-scroll-target="#方法1-交叉验证">方法1 交叉验证</a></li>
  <li><a href="#方法2-100次迭代" id="toc-方法2-100次迭代" class="nav-link" data-scroll-target="#方法2-100次迭代">方法2 100次迭代</a></li>
  <li><a href="#方法3-岭迹图主观选取" id="toc-方法3-岭迹图主观选取" class="nav-link" data-scroll-target="#方法3-岭迹图主观选取">方法3 岭迹图主观选取</a></li>
  </ul></li>
  <li><a href="#方程各系数" id="toc-方程各系数" class="nav-link" data-scroll-target="#方程各系数">方程各系数</a></li>
  <li><a href="#拟合效果评价" id="toc-拟合效果评价" class="nav-link" data-scroll-target="#拟合效果评价">拟合效果评价</a></li>
  <li><a href="#岭回归的r2值和均方误差mse的值" id="toc-岭回归的r2值和均方误差mse的值" class="nav-link" data-scroll-target="#岭回归的r2值和均方误差mse的值">岭回归的R2值和均方误差MSE的值</a></li>
  </ul></li>
  <li><a href="#黄酮类flavonoids" id="toc-黄酮类flavonoids" class="nav-link" data-scroll-target="#黄酮类flavonoids">黄酮类（Flavonoids）</a>
  <ul class="collapse">
  <li><a href="#全部变量线性回归" id="toc-全部变量线性回归" class="nav-link" data-scroll-target="#全部变量线性回归">全部变量线性回归</a></li>
  <li><a href="#最优子集法筛选模型-1" id="toc-最优子集法筛选模型-1" class="nav-link" data-scroll-target="#最优子集法筛选模型-1">最优子集法筛选模型</a></li>
  <li><a href="#模型诊断" id="toc-模型诊断" class="nav-link" data-scroll-target="#模型诊断">模型诊断</a></li>
  <li><a href="#岭回归-1" id="toc-岭回归-1" class="nav-link" data-scroll-target="#岭回归-1">岭回归</a>
  <ul class="collapse">
  <li><a href="#方程各系数-1" id="toc-方程各系数-1" class="nav-link" data-scroll-target="#方程各系数-1">方程各系数</a></li>
  <li><a href="#岭回归的r2值和均方误差mse" id="toc-岭回归的r2值和均方误差mse" class="nav-link" data-scroll-target="#岭回归的r2值和均方误差mse">岭回归的R2值和均方误差(MSE)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#皂苷类saponin" id="toc-皂苷类saponin" class="nav-link" data-scroll-target="#皂苷类saponin">皂苷类（saponin）</a>
  <ul class="collapse">
  <li><a href="#全部指标建模" id="toc-全部指标建模" class="nav-link" data-scroll-target="#全部指标建模">全部指标建模</a></li>
  <li><a href="#最优子集筛选" id="toc-最优子集筛选" class="nav-link" data-scroll-target="#最优子集筛选">最优子集筛选</a></li>
  <li><a href="#岭回归-2" id="toc-岭回归-2" class="nav-link" data-scroll-target="#岭回归-2">岭回归</a>
  <ul class="collapse">
  <li><a href="#绘制岭回归的残差图" id="toc-绘制岭回归的残差图" class="nav-link" data-scroll-target="#绘制岭回归的残差图">绘制岭回归的残差图</a></li>
  <li><a href="#岭回归的r2值和均方误差mse-1" id="toc-岭回归的r2值和均方误差mse-1" class="nav-link" data-scroll-target="#岭回归的r2值和均方误差mse-1">岭回归的R2值和均方误差(MSE)</a></li>
  <li><a href="#方程各系数-2" id="toc-方程各系数-2" class="nav-link" data-scroll-target="#方程各系数-2">方程各系数</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#生物碱alkaloids" id="toc-生物碱alkaloids" class="nav-link" data-scroll-target="#生物碱alkaloids">生物碱(Alkaloids)</a>
  <ul class="collapse">
  <li><a href="#全部变量线性回归-1" id="toc-全部变量线性回归-1" class="nav-link" data-scroll-target="#全部变量线性回归-1">全部变量线性回归</a></li>
  <li><a href="#最优子集法筛选模型-2" id="toc-最优子集法筛选模型-2" class="nav-link" data-scroll-target="#最优子集法筛选模型-2">最优子集法筛选模型</a></li>
  <li><a href="#模型诊断-1" id="toc-模型诊断-1" class="nav-link" data-scroll-target="#模型诊断-1">模型诊断</a></li>
  <li><a href="#岭回归-3" id="toc-岭回归-3" class="nav-link" data-scroll-target="#岭回归-3">岭回归</a>
  <ul class="collapse">
  <li><a href="#方程各系数-3" id="toc-方程各系数-3" class="nav-link" data-scroll-target="#方程各系数-3">方程各系数</a></li>
  <li><a href="#岭回归的r2值和均方误差mse-2" id="toc-岭回归的r2值和均方误差mse-2" class="nav-link" data-scroll-target="#岭回归的r2值和均方误差mse-2">岭回归的R2值和均方误差(MSE)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#酚类phenols" id="toc-酚类phenols" class="nav-link" data-scroll-target="#酚类phenols">酚类(Phenols)</a>
  <ul class="collapse">
  <li><a href="#全部变量线性回归-2" id="toc-全部变量线性回归-2" class="nav-link" data-scroll-target="#全部变量线性回归-2">全部变量线性回归</a></li>
  <li><a href="#最优子集法筛选模型-3" id="toc-最优子集法筛选模型-3" class="nav-link" data-scroll-target="#最优子集法筛选模型-3">最优子集法筛选模型</a></li>
  <li><a href="#模型诊断-2" id="toc-模型诊断-2" class="nav-link" data-scroll-target="#模型诊断-2">模型诊断</a></li>
  <li><a href="#岭回归-4" id="toc-岭回归-4" class="nav-link" data-scroll-target="#岭回归-4">岭回归</a>
  <ul class="collapse">
  <li><a href="#方程各系数-4" id="toc-方程各系数-4" class="nav-link" data-scroll-target="#方程各系数-4">方程各系数</a></li>
  <li><a href="#岭回归的r2值和均方误差mse-3" id="toc-岭回归的r2值和均方误差mse-3" class="nav-link" data-scroll-target="#岭回归的r2值和均方误差mse-3">岭回归的R2值和均方误差(MSE)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#萜类terpenes" id="toc-萜类terpenes" class="nav-link" data-scroll-target="#萜类terpenes">萜类(Terpenes)</a>
  <ul class="collapse">
  <li><a href="#全部变量线性回归-3" id="toc-全部变量线性回归-3" class="nav-link" data-scroll-target="#全部变量线性回归-3">全部变量线性回归</a></li>
  <li><a href="#最优子集法筛选模型-4" id="toc-最优子集法筛选模型-4" class="nav-link" data-scroll-target="#最优子集法筛选模型-4">最优子集法筛选模型</a></li>
  <li><a href="#模型诊断-3" id="toc-模型诊断-3" class="nav-link" data-scroll-target="#模型诊断-3">模型诊断</a></li>
  <li><a href="#岭回归-5" id="toc-岭回归-5" class="nav-link" data-scroll-target="#岭回归-5">岭回归</a>
  <ul class="collapse">
  <li><a href="#方程各系数-5" id="toc-方程各系数-5" class="nav-link" data-scroll-target="#方程各系数-5">方程各系数</a></li>
  <li><a href="#岭回归的r2值和均方误差mse-4" id="toc-岭回归的r2值和均方误差mse-4" class="nav-link" data-scroll-target="#岭回归的r2值和均方误差mse-4">岭回归的R2值和均方误差(MSE)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#苯丙素类ppp" id="toc-苯丙素类ppp" class="nav-link" data-scroll-target="#苯丙素类ppp">苯丙素类(PPP)</a>
  <ul class="collapse">
  <li><a href="#全部变量线性回归-4" id="toc-全部变量线性回归-4" class="nav-link" data-scroll-target="#全部变量线性回归-4">全部变量线性回归</a></li>
  <li><a href="#最优子集法筛选模型-5" id="toc-最优子集法筛选模型-5" class="nav-link" data-scroll-target="#最优子集法筛选模型-5">最优子集法筛选模型</a></li>
  <li><a href="#模型诊断-4" id="toc-模型诊断-4" class="nav-link" data-scroll-target="#模型诊断-4">模型诊断</a></li>
  <li><a href="#岭回归-6" id="toc-岭回归-6" class="nav-link" data-scroll-target="#岭回归-6">岭回归</a>
  <ul class="collapse">
  <li><a href="#方程各系数-6" id="toc-方程各系数-6" class="nav-link" data-scroll-target="#方程各系数-6">方程各系数</a></li>
  <li><a href="#岭回归的r2值和均方误差mse-5" id="toc-岭回归的r2值和均方误差mse-5" class="nav-link" data-scroll-target="#岭回归的r2值和均方误差mse-5">岭回归的R2值和均方误差(MSE)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#预测新值" id="toc-预测新值" class="nav-link" data-scroll-target="#预测新值">预测新值</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chase-maker/edit/main/TCM/线性回归模型.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chase-maker/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../TCM/contents2.html">中医药研究TCM</a></li><li class="breadcrumb-item"><a href="../TCM/线性回归模型.html">线性回归模型</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">线性回归模型</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>杨文灿 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 26, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
✏️本节导读
</div>
</div>
<div class="callout-body-container callout-body">
<p>本节首先对自变量进行标准化，由于因变量不满足正态分布，于是将其取对数变为log10ec50；</p>
<p>之后观察各自变量与因变量之间是否存在线性关系，构建十三个自变量与自变量之间的多元回归模型；</p>
<p>对回归模型进行诊断，发现存在多重共线性，拟合程度低等问题；进一步分析发现根本原因是不同种类的数据之间差异太大； 于是分种类构建多元线性回归模型，并通过最优子集法筛选简化变量，拟合度较高。</p>
</div>
</div>
<section id="数据导入" class="level1">
<h1>数据导入</h1>
<p>对自变量进行标准化：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> EC50[,<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>] <span class="ot">&lt;-</span> <span class="fu">scale</span>(EC50[,<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Q6:为什么不对因变量进行标准化
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>自变量标准化主要是为了消除不同自变量之间由于量纲、数量级等差异所带来的影响。注意：标准化只是改变了横纵坐标的取值大小，但并不改变变量的分布趋势。</p></li>
<li><p>因变量可以标准化，也可以不进行标准化。</p></li>
<li><p>如果我们的主要目的是预测因变量的实际值，那么一般不对因变量进行标准化。</p></li>
<li><p>如果我们关注模型参数的某些性质（如系数大小的直接比较等），筛选观察不同变量之间的重要性程度等，一般对因变量进行标准化。</p></li>
</ul>
</div>
</div>
<p>展示处理后数据的前6行</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">head</span>(EC50)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           AKT1         PKC     PIK3CA        PDE5        AMPK       eNOS
   1 -0.7152059  0.23097874 -0.7268737  0.04982355  0.20954781  0.2943302
   2 -1.6765444 -0.02762759 -0.7328289 -0.51239489 -0.47411811 -0.7139716
   3 -0.2400386  0.76304378  0.5526296  0.72232070  2.01150159  0.6636944
   4 -1.6915497 -0.16479378 -1.2653881 -1.34591248 -0.26202904 -0.9807731
   5 -1.5274919 -0.09490018 -0.5167425 -0.10104854 -0.22507412 -0.5968561
   6 -1.3014123  0.09293888 -0.5439660 -0.90682732  0.03441365 -0.1838335
          SIRT1       PDK1       PRKG1      APLNR        TGR5       EDNRB
   1  0.3619633 -0.2178962 -0.22979037  0.5236092  0.42771601  0.08453003
   2 -0.7595274 -0.8141069 -0.62275985 -0.8581196 -0.43231481 -1.05226713
   3  1.8156919  1.2150377  1.17524017  1.4959677  1.31641452  0.82725913
   4 -0.7565207 -0.9155279 -0.34724214 -0.9727101 -0.55098573 -1.27200466
   5 -0.7437423 -0.6460378 -0.64032273 -0.8929950 -0.16963873 -0.86090897
   6 -0.5588317 -0.5793897  0.06658326 -0.6206350  0.06170289 -0.74252639
         CYP1A1    ec50 log10ec50
   1 -0.8397743  53.703  1.729999
   2 -0.8713804  80.630  1.906497
   3  2.9208875  17.380  1.240050
   4 -0.9438886 312.250  2.494502
   5 -0.8871835  34.780  1.541330
   6 -0.5106990 254.590  2.405841</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
数据介绍
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>数据有十三个连续型变量作为自变量，这些变量是十三个舒张血管通路上的靶点蛋白。每一条数据是不同的蛋白化合物与这些靶点蛋白的结合能数据值。</p></li>
<li><p>数据有一个连续型因变量是ec50值，由于ec50值的跨度比较大，不满足正态分布的优良性质，因此我们取log10(ec50)做为之后连续型分析的指标。ec50值是判断蛋白化合物舒张血管作用大小的权威指标。一般认为ec50&lt;300的蛋白化合物具有舒张血管作用，ec50值越小，该蛋白化合物的舒张血管作用越明显。</p></li>
<li><p>该数据有196条数据，主要是由6种蛋白化合物构成，例如：黄酮类、皂苷类、生物碱类、酚类、萜类、苯丙素类。</p></li>
<li><p>本研究的主要目的是构建模型，使用蛋白化合物与十三个靶点蛋白的结合能预测log10ec50值，进而判断该蛋白化合物舒张血管的作用的强弱，进而自动帮助我们筛选具有舒张血管作用的蛋白化合物，一定程度上减少一个一个做实验验证带来的人力、物力、财力和时间的花费。</p></li>
</ol>
</div>
</div>
</section>
<section id="观测各变量趋势" class="level1">
<h1>观测各变量趋势</h1>
<section id="以ec50为因变量" class="level2">
<h2 class="anchored" data-anchor-id="以ec50为因变量">以ec50为因变量</h2>
<p>以ec50为因变量作图，我们发现，由于ec50值跨度太大，无法体现其与各个自变量之间是否具有线性趋势。因此我们尝试log10ec50作为我们的因变量。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> A <span class="ot">&lt;-</span> <span class="fu">names</span>(EC50)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="cf">for</span>(i <span class="cf">in</span> A){</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span> EC50,<span class="at">mapping=</span> <span class="fu">aes_string</span>(<span class="at">x=</span>i,<span class="at">y=</span><span class="st">"ec50"</span>,<span class="at">group=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="fu">print</span>(a)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="以log10ec50为因变量" class="level2">
<h2 class="anchored" data-anchor-id="以log10ec50为因变量">以log10ec50为因变量</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="cf">for</span>(i <span class="cf">in</span> A){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span> EC50,<span class="at">mapping=</span> <span class="fu">aes_string</span>(<span class="at">x=</span>i,<span class="at">y=</span><span class="st">"log10ec50"</span>,<span class="at">group=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="fu">print</span>(a)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="各种化合物类型的结合能差异" class="level2">
<h2 class="anchored" data-anchor-id="各种化合物类型的结合能差异">各种化合物类型的结合能差异</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(readxl)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> EC50_1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"D:</span><span class="sc">\\</span><span class="st">Rstudio</span><span class="sc">\\</span><span class="st">Rmyfile</span><span class="sc">\\</span><span class="st">Traditional Chinese Medicine</span><span class="sc">\\</span><span class="st">EC50种类图.xlsx"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> EC50_1<span class="sc">$</span>ec50 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(EC50_1<span class="sc">$</span>ec50)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> EC50_1<span class="sc">$</span>log10ec50 <span class="ot">&lt;-</span> <span class="fu">log10</span>(EC50_1<span class="sc">$</span>ec50)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(tidyverse)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> p1 <span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> EC50_1 ,<span class="fu">aes</span>(<span class="at">x=</span>Species,<span class="at">y=</span>log10ec50))<span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">theme_classic</span>()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> p2 <span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> EC50_1 ,<span class="fu">aes</span>(<span class="at">x=</span>Species,<span class="at">y=</span>AKT1))<span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">theme_classic</span>()</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> p3 <span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> EC50_1 ,<span class="fu">aes</span>(<span class="at">x=</span>Species,<span class="at">y=</span>PKC))<span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(gridExtra)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(dplyr)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> p_final <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(p1, <span class="fu">arrangeGrob</span>(p2, p3, <span class="at">ncol=</span><span class="dv">2</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggsave</span>(<span class="st">"EC50种类分布图.png"</span>,p_final,<span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>我们发现不同种类的log10ec50值存在差异。</p>
<p>不同种类蛋白化合物与靶点蛋白的结合能也存在差异。</p>
<p>这将导致数据整体之间的方差增大。使得线性模型集合比较困难。</p>
</div>
</div>
</section>
</section>
<section id="对所有指标构建线性模型" class="level1">
<h1>对所有指标构建线性模型</h1>
<p>仅有三个变量显著，可解释20%的方差</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> EC50[,<span class="dv">15</span>] </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> EC50[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">14</span>)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model <span class="ot">&lt;-</span> <span class="fu">lm</span>(log10ec50<span class="sc">~</span>.<span class="sc">-</span>ec50,<span class="at">data =</span> EC50)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ . - ec50, data = EC50)
   
   Residuals:
        Min       1Q   Median       3Q      Max 
   -3.12158 -0.58477  0.02202  0.65812  2.65826 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)  1.46962    0.08402  17.492   &lt;2e-16 ***
   AKT1         0.12327    0.13630   0.904    0.367    
   PKC         -0.18805    0.20997  -0.896    0.372    
   PIK3CA       0.14539    0.19609   0.741    0.459    
   PDE5        -0.27717    0.25187  -1.100    0.273    
   AMPK        -0.13888    0.28428  -0.489    0.626    
   eNOS        -0.27270    0.20394  -1.337    0.183    
   SIRT1        0.28187    0.25089   1.123    0.263    
   PDK1         0.06393    0.20653   0.310    0.757    
   PRKG1       -0.10408    0.16246  -0.641    0.523    
   APLNR       -0.24339    0.25401  -0.958    0.339    
   TGR5         0.28460    0.21703   1.311    0.191    
   EDNRB       -0.14917    0.23124  -0.645    0.520    
   CYP1A1      -0.02094    0.13216  -0.158    0.874    
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 1.176 on 182 degrees of freedom
   Multiple R-squared:  0.1843, Adjusted R-squared:  0.126 
   F-statistic: 3.162 on 13 and 182 DF,  p-value: 0.000272</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># 预测</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> EC50)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression MSE: 1.2846903485486"</code></pre>
</div>
</div>
<section id="线性模型诊断" class="level2">
<h2 class="anchored" data-anchor-id="线性模型诊断">线性模型诊断</h2>
<p>对已经构建的模型进行诊断：</p>
<p>满足正态性，方差齐性，数据表现良好，但多个变量之间的共线性较高。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(YangPac)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ModelDiagnose</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "------------------正态性检验--------------------"
   Warning: Non-normality of residuals detected (p = 0.013).
   
   [1] "-----------异方差性（方差齐性）检验---------------"
   OK: Error variance appears to be homoscedastic (p = 0.139).
   
   [1] "----------------自相关性检验--------------------"
   OK: Residuals appear to be independent and not autocorrelated (p = 0.510).
   
   [1] "-----------多重共线性性检验---------------"
   # Check for Multicollinearity
   
   Low Correlation
   
      Term  VIF    VIF 95% CI Increased SE Tolerance Tolerance 95% CI
      AKT1 2.62 [2.16,  3.26]         1.62      0.38     [0.31, 0.46]
     PRKG1 3.72 [3.01,  4.69]         1.93      0.27     [0.21, 0.33]
    CYP1A1 2.46 [2.04,  3.06]         1.57      0.41     [0.33, 0.49]
   
   Moderate Correlation
   
      Term  VIF    VIF 95% CI Increased SE Tolerance Tolerance 95% CI
       PKC 6.21 [4.94,  7.91]         2.49      0.16     [0.13, 0.20]
    PIK3CA 5.42 [4.32,  6.88]         2.33      0.18     [0.15, 0.23]
      PDE5 8.94 [7.05, 11.43]         2.99      0.11     [0.09, 0.14]
      eNOS 5.86 [4.66,  7.45]         2.42      0.17     [0.13, 0.21]
     SIRT1 8.87 [6.99, 11.34]         2.98      0.11     [0.09, 0.14]
      PDK1 6.01 [4.78,  7.65]         2.45      0.17     [0.13, 0.21]
     APLNR 9.09 [7.16, 11.63]         3.02      0.11     [0.09, 0.14]
      TGR5 6.64 [5.26,  8.46]         2.58      0.15     [0.12, 0.19]
     EDNRB 7.54 [5.96,  9.62]         2.75      0.13     [0.10, 0.17]
   
   High Correlation
   
    Term   VIF    VIF 95% CI Increased SE Tolerance Tolerance 95% CI
    AMPK 11.39 [8.94, 14.60]         3.37      0.09     [0.07, 0.11]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="相关性图" class="level2">
<h2 class="anchored" data-anchor-id="相关性图">相关性图</h2>
<p>发现除了CYP1A1之外，其他变量之间都存在较强的正相关关系。</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="最优子集法筛选模型" class="level2">
<h2 class="anchored" data-anchor-id="最优子集法筛选模型">最优子集法筛选模型</h2>
<p>保留了几个变量，线性关系较为显著（P&lt;0.0001)，但解释程度仍然不高(Adjusted R-squared:0.1386)。</p>
<pre><code>  </code></pre>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ PDE5, data = EC50)
   
   Residuals:
       Min      1Q  Median      3Q     Max 
   -3.6312 -0.5899  0.0133  0.7747  2.9220 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)  1.46962    0.08341  17.619  &lt; 2e-16 ***
   PDE5        -0.47572    0.08362  -5.689 4.66e-08 ***
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 1.168 on 194 degrees of freedom
   Multiple R-squared:  0.143,  Adjusted R-squared:  0.1386 
   F-statistic: 32.36 on 1 and 194 DF,  p-value: 4.657e-08</code></pre>
</div>
</div>
</section>
</section>
<section id="岭回归" class="level1">
<h1>岭回归</h1>
<p>解释：自变量之间存在多重共线性，普通最小二乘法将不适用。</p>
<p>方法1：剔除多重共线性较高的变量；</p>
<p>方法2：岭回归，是一种有偏的估计，以损失部分信息，降低精度为代价获得回归系数，对于存在离群点的数据拟合要强于最二乘法。它的有偏性可以缓解多重共线性问题以及过度拟合问题。但也因其有偏，𝜆值越大，偏离程度也会越大，拟合的效果也会越来越小。</p>
<p>𝜆为岭系数，𝜷为岭回归的回归系数</p>
<p><img src="images/微信图片_20240617183853.png" class="img-fluid" width="257"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> EC50[,<span class="dv">15</span>] <span class="sc">|&gt;</span><span class="fu">as.matrix</span>()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> EC50[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">14</span>)] <span class="sc">|&gt;</span><span class="fu">as.matrix</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="计算岭系数" class="level2">
<h2 class="anchored" data-anchor-id="计算岭系数">计算岭系数</h2>
<section id="方法1-交叉验证" class="level3">
<h3 class="anchored" data-anchor-id="方法1-交叉验证">方法1 交叉验证</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cvfit <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x,y,<span class="at">type=</span><span class="st">"mse"</span>,<span class="at">nfolds =</span> <span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.01</span>, <span class="at">missing_value =</span> T)<span class="co">#交叉验证函数</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#a=0,岭回归，a=0-1之间，弹性网络，a=1,lasso回归</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">plot</span>(cvfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cvfit<span class="sc">$</span>lambda.min<span class="co">#均方误差最小的𝜆值</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] 1.828531</code></pre>
</div>
</div>
</section>
<section id="方法2-100次迭代" class="level3">
<h3 class="anchored" data-anchor-id="方法2-100次迭代">方法2 100次迭代</h3>
<p>选取最小的lambda值，0.05。作为之后岭回归的惩罚系数。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ridge <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y,<span class="at">family =</span> <span class="st">"gaussian"</span>,<span class="at">alpha =</span> <span class="dv">0</span>)<span class="co">#gaussian,指的是因变量是连续性变量的情况；family=binomial因变量为分类变量</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(ridge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:  glmnet(x = x, y = y, family = "gaussian", alpha = 0) 
   
       Df  %Dev Lambda
   1   13  0.00 474.50
   2   13  0.74 432.40
   3   13  0.81 393.90
   4   13  0.89 358.90
   5   13  0.97 327.10
   6   13  1.06 298.00
   7   13  1.16 271.50
   8   13  1.26 247.40
   9   13  1.38 225.40
   10  13  1.50 205.40
   11  13  1.63 187.20
   12  13  1.78 170.50
   13  13  1.93 155.40
   14  13  2.10 141.60
   15  13  2.28 129.00
   16  13  2.47 117.50
   17  13  2.68 107.10
   18  13  2.90  97.58
   19  13  3.13  88.91
   20  13  3.38  81.02
   21  13  3.64  73.82
   22  13  3.92  67.26
   23  13  4.21  61.29
   24  13  4.52  55.84
   25  13  4.84  50.88
   26  13  5.18  46.36
   27  13  5.52  42.24
   28  13  5.88  38.49
   29  13  6.25  35.07
   30  13  6.62  31.95
   31  13  7.01  29.12
   32  13  7.40  26.53
   33  13  7.79  24.17
   34  13  8.18  22.02
   35  13  8.58  20.07
   36  13  8.97  18.29
   37  13  9.35  16.66
   38  13  9.73  15.18
   39  13 10.09  13.83
   40  13 10.45  12.60
   41  13 10.79  11.48
   42  13 11.12  10.46
   43  13 11.44   9.53
   44  13 11.73   8.69
   45  13 12.02   7.92
   46  13 12.28   7.21
   47  13 12.53   6.57
   48  13 12.77   5.99
   49  13 12.98   5.46
   50  13 13.19   4.97
   51  13 13.38   4.53
   52  13 13.56   4.13
   53  13 13.72   3.76
   54  13 13.88   3.43
   55  13 14.02   3.12
   56  13 14.16   2.85
   57  13 14.29   2.59
   58  13 14.42   2.36
   59  13 14.54   2.15
   60  13 14.65   1.96
   61  13 14.76   1.79
   62  13 14.87   1.63
   63  13 14.98   1.48
   64  13 15.09   1.35
   65  13 15.20   1.23
   66  13 15.30   1.12
   67  13 15.41   1.02
   68  13 15.51   0.93
   69  13 15.62   0.85
   70  13 15.73   0.77
   71  13 15.84   0.70
   72  13 15.94   0.64
   73  13 16.05   0.58
   74  13 16.16   0.53
   75  13 16.27   0.49
   76  13 16.38   0.44
   77  13 16.50   0.40
   78  13 16.61   0.37
   79  13 16.71   0.33
   80  13 16.82   0.30
   81  13 16.93   0.28
   82  13 17.03   0.25
   83  13 17.13   0.23
   84  13 17.23   0.21
   85  13 17.33   0.19
   86  13 17.42   0.17
   87  13 17.51   0.16
   88  13 17.59   0.14
   89  13 17.67   0.13
   90  13 17.74   0.12
   91  13 17.81   0.11
   92  13 17.87   0.10
   93  13 17.93   0.09
   94  13 17.99   0.08
   95  13 18.04   0.08
   96  13 18.08   0.07
   97  13 18.12   0.06
   98  13 18.16   0.06
   99  13 18.19   0.05
   100 13 18.22   0.05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#100次迭代中找到最优的𝜆值；第三列是方差解释率，最后一列为𝜆取值。</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="方法3-岭迹图主观选取" class="level3">
<h3 class="anchored" data-anchor-id="方法3-岭迹图主观选取">方法3 岭迹图主观选取</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="方程各系数" class="level2">
<h2 class="anchored" data-anchor-id="方程各系数">方程各系数</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   14 x 1 sparse Matrix of class "dgCMatrix"
                        s1
   (Intercept)  1.46961855
   AKT1         0.10954607
   PKC         -0.15147531
   PIK3CA       0.10440970
   PDE5        -0.22758172
   AMPK        -0.11010478
   eNOS        -0.21918436
   SIRT1        0.18337012
   PDK1         0.04530627
   PRKG1       -0.09202807
   APLNR       -0.21150215
   TGR5         0.19878027
   EDNRB       -0.10397655
   CYP1A1      -0.02689341</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(ridge,<span class="at">xvar=</span><span class="st">"dev"</span>,<span class="at">label =</span> T)<span class="co">#解释偏差的程度和回归系数的关系</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="拟合效果评价" class="level2">
<h2 class="anchored" data-anchor-id="拟合效果评价">拟合效果评价</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#拟合值</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> ridge.y<span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge,<span class="at">newx=</span>x,<span class="at">s=</span><span class="fl">0.03</span>,<span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(ridge.y,y,<span class="at">xlab=</span><span class="st">"Predicted"</span>,<span class="at">ylab =</span> <span class="st">"Actual"</span>,<span class="at">main =</span> <span class="st">"Ridge Regression"</span>)<span class="co">#预测点在y=x的线上上下波动，表明拟合效果较好。</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># 理想情况下，真实值和预测值是相等的（即y=x）</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="岭回归的r2值和均方误差mse的值" class="level2">
<h2 class="anchored" data-anchor-id="岭回归的r2值和均方误差mse的值">岭回归的R2值和均方误差MSE的值</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   Mean Squared Error (MSE): 1.288113 
   R Squared (rsq): 0.1820842</code></pre>
</div>
</div>
<p>岭回归可以提升模型的拟合程度R2，一定程度上解决变量之间的共线性问题，但是无法大幅提升模型的拟合程度，说明模型拟合程度不高的根本原因，不仅仅是变量之间的共线性，还有其他的因素，例如变量的方差过大。</p>
<p>均方误差的值，在一定程度上体现了变量的变异程度较大。使得模型的线性关系不稳定。接下来我们将分种类构建，不同种类的蛋白化合物与13个靶点蛋白的结合能对log10ec50的回归预测模型。</p>
</section>
</section>
<section id="黄酮类flavonoids" class="level1">
<h1>黄酮类（Flavonoids）</h1>
<section id="全部变量线性回归" class="level2">
<h2 class="anchored" data-anchor-id="全部变量线性回归">全部变量线性回归</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(easystats)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model <span class="ot">&lt;-</span> <span class="fu">lm</span>(log10ec50 <span class="sc">~</span>.<span class="sc">-</span>ec50,<span class="at">data =</span> Flavonoids)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   <span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ . - ec50, data = Flavonoids)
   
   Residuals:
        Min       1Q   Median       3Q      Max 
   -0.71490 -0.31584  0.03926  0.21504  0.69502 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)  10.6812     3.1996   3.338 0.004492 ** 
   AKT1         -0.1145     0.4619  -0.248 0.807661    
   PKC           0.4701     0.2156   2.180 0.045600 *  
   PIK3CA        0.7565     0.3114   2.429 0.028159 *  
   PDE5          0.7903     0.2988   2.645 0.018384 *  
   AMPK         -2.2291     0.6276  -3.552 0.002898 ** 
   eNOS          0.7679     0.5434   1.413 0.177984    
   SIRT1        -0.2794     0.3171  -0.881 0.392089    
   PDK1          1.3519     0.4878   2.772 0.014253 *  
   PRKG1         0.4012     0.2568   1.563 0.138967    
   APLNR        -2.0091     0.3867  -5.195 0.000109 ***
   TGR5         -0.1906     0.3243  -0.588 0.565557    
   EDNRB        -0.7499     0.4098  -1.830 0.087202 .  
   CYP1A1       -0.2155     0.1513  -1.424 0.174932    
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 0.5422 on 15 degrees of freedom
   Multiple R-squared:  0.8278, Adjusted R-squared:  0.6785 
   F-statistic: 5.546 on 13 and 15 DF,  p-value: 0.001167</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> Flavonoids[,<span class="dv">15</span>] <span class="sc">|&gt;</span><span class="fu">as.matrix</span>()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> Flavonoids[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">14</span>)] <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">as.matrix</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># 预测</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> Flavonoids)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression MSE: 0.152061911817757"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression AIC:"</span>, <span class="fu">AIC</span>(model)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression AIC: 57.6778766580835"</code></pre>
</div>
</div>
</section>
<section id="最优子集法筛选模型-1" class="level2">
<h2 class="anchored" data-anchor-id="最优子集法筛选模型-1">最优子集法筛选模型</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model_final <span class="ot">&lt;-</span> model<span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select_parameters</span>() </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(model_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ PKC + PIK3CA + PDE5 + AMPK + eNOS + 
       PDK1 + PRKG1 + APLNR + EDNRB + CYP1A1, data = Flavonoids)
   
   Residuals:
        Min       1Q   Median       3Q      Max 
   -0.87577 -0.30203  0.04005  0.39952  0.68372 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)   9.9965     2.6347   3.794 0.001329 ** 
   PKC           0.4268     0.1997   2.137 0.046587 *  
   PIK3CA        0.6204     0.2586   2.399 0.027488 *  
   PDE5          0.7417     0.2466   3.008 0.007557 ** 
   AMPK         -2.1547     0.5205  -4.140 0.000615 ***
   eNOS          0.5935     0.4484   1.324 0.202193    
   PDK1          1.2893     0.4571   2.820 0.011329 *  
   PRKG1         0.4015     0.2386   1.682 0.109748    
   APLNR        -1.9399     0.3396  -5.713 2.04e-05 ***
   EDNRB        -0.9412     0.3250  -2.896 0.009625 ** 
   CYP1A1       -0.2101     0.1001  -2.099 0.050230 .  
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 0.5175 on 18 degrees of freedom
   Multiple R-squared:  0.8117, Adjusted R-squared:  0.7071 
   F-statistic: 7.761 on 10 and 18 DF,  p-value: 0.0001014</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_final, <span class="at">newdata =</span> Flavonoids)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 MSE: 0.166240947980718"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 AIC:"</span>, <span class="fu">AIC</span>(model_final)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 AIC: 54.2632405000913"</code></pre>
</div>
</div>
</section>
<section id="模型诊断" class="level2">
<h2 class="anchored" data-anchor-id="模型诊断">模型诊断</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(YangPac)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ModelDiagnose</span>(model_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "------------------正态性检验--------------------"
   OK: residuals appear as normally distributed (p = 0.061).
   
   [1] "-----------异方差性（方差齐性）检验---------------"
   OK: Error variance appears to be homoscedastic (p = 0.312).
   
   [1] "----------------自相关性检验--------------------"
   OK: Residuals appear to be independent and not autocorrelated (p = 0.530).
   
   [1] "-----------多重共线性性检验---------------"
   # Check for Multicollinearity
   
   Low Correlation
   
      Term  VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI
       PKC 2.36 [ 1.78,  3.37]         1.54      0.42     [0.30, 0.56]
    PIK3CA 4.42 [ 3.15,  6.45]         2.10      0.23     [0.16, 0.32]
      PDE5 4.97 [ 3.51,  7.28]         2.23      0.20     [0.14, 0.28]
     PRKG1 1.97 [ 1.52,  2.79]         1.40      0.51     [0.36, 0.66]
    CYP1A1 4.26 [ 3.04,  6.21]         2.06      0.23     [0.16, 0.33]
   
   Moderate Correlation
   
     Term  VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI
     AMPK 8.70 [ 5.99, 12.87]         2.95      0.11     [0.08, 0.17]
    APLNR 6.54 [ 4.55,  9.62]         2.56      0.15     [0.10, 0.22]
    EDNRB 8.05 [ 5.56, 11.90]         2.84      0.12     [0.08, 0.18]
   
   High Correlation
   
    Term   VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI
    eNOS 20.28 [13.71, 30.26]         4.50      0.05     [0.03, 0.07]
    PDK1 14.20 [ 9.66, 21.12]         3.77      0.07     [0.05, 0.10]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="岭回归-1" class="level2">
<h2 class="anchored" data-anchor-id="岭回归-1">岭回归</h2>
<section id="方程各系数-1" class="level3">
<h3 class="anchored" data-anchor-id="方程各系数-1">方程各系数</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   14 x 1 sparse Matrix of class "dgCMatrix"
                        s1
   (Intercept)  5.82005794
   AKT1        -0.30101576
   PKC          0.42549417
   PIK3CA       0.62300752
   PDE5         0.57819308
   AMPK        -1.00340963
   eNOS         0.13126786
   SIRT1       -0.05636896
   PDK1         0.57365719
   PRKG1        0.20635375
   APLNR       -1.28264565
   TGR5        -0.02791703
   EDNRB       -0.34596150
   CYP1A1      -0.20431364</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ridge.y<span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge,<span class="at">newx=</span>x,<span class="at">s=</span><span class="fl">0.035</span>,<span class="at">type =</span> <span class="st">"response"</span>) </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(ridge.y,y,<span class="at">xlab=</span><span class="st">"Predicted"</span>,<span class="at">ylab =</span> <span class="st">"Actual"</span>,<span class="at">main =</span> <span class="st">"Ridge Regression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="岭回归的r2值和均方误差mse" class="level3">
<h3 class="anchored" data-anchor-id="岭回归的r2值和均方误差mse">岭回归的R2值和均方误差(MSE)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">R2_mse</span>(Flavonoids,ridge,<span class="fl">0.0035</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mean Squared Error (MSE): 0.212761 
   R Squared (rsq): 0.7590446</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="皂苷类saponin" class="level1">
<h1>皂苷类（saponin）</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> saponin[,<span class="dv">15</span>] <span class="sc">|&gt;</span><span class="fu">as.matrix</span>()</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> saponin[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">14</span>)] <span class="sc">|&gt;</span><span class="fu">as.matrix</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="全部指标建模" class="level2">
<h2 class="anchored" data-anchor-id="全部指标建模">全部指标建模</h2>
<p>多元R2值较高，调整后的R2值0.09，差距较大，P值0.5&gt;0.05，方程解释程度较小，说明该种蛋白化合物数据各个自变量之间的共线性影响较为严重。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model <span class="ot">&lt;-</span> <span class="fu">lm</span>(log10ec50<span class="sc">~</span>.<span class="sc">-</span>ec50,<span class="at">data =</span> saponin)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   <span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ . - ec50, data = saponin)
   
   Residuals:
           1         2         3         4         5         6         7         8 
   -0.147787  0.538207  0.725845  0.906822 -0.003582  0.258288  0.844916 -0.028152 
           9        10        11        12        13        14        15        16 
   -0.194170 -1.274131 -0.802024 -0.025112  0.304528 -1.572631  0.456686  0.260566 
          17 
   -0.248268 
   
   Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)
   (Intercept) -10.99950   16.12040  -0.682    0.544
   AKT1          0.14205    1.10368   0.129    0.906
   PKC          -2.81219    1.24063  -2.267    0.108
   PIK3CA        2.34133    1.52878   1.532    0.223
   PDE5         -1.62499    0.92723  -1.753    0.178
   AMPK         -0.33138    1.56407  -0.212    0.846
   eNOS          0.12290    0.86885   0.141    0.896
   SIRT1         0.04535    1.53406   0.030    0.978
   PDK1          0.49772    1.02797   0.484    0.661
   PRKG1        -0.61160    1.51218  -0.404    0.713
   APLNR         1.12437    5.41104   0.208    0.849
   TGR5          0.33007    1.02006   0.324    0.768
   EDNRB         1.67705    3.18247   0.527    0.635
   CYP1A1        0.29971    2.26942   0.132    0.903
   
   Residual standard error: 1.597 on 3 degrees of freedom
   Multiple R-squared:   0.83,  Adjusted R-squared:  0.09307 
   F-statistic: 1.126 on 13 and 3 DF,  p-value: 0.5269</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># 预测</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> saponin)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression MSE: 0.450063010837608"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression AIC:"</span>, <span class="fu">AIC</span>(model)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression AIC: 64.6716595360358"</code></pre>
</div>
</div>
</section>
<section id="最优子集筛选" class="level2">
<h2 class="anchored" data-anchor-id="最优子集筛选">最优子集筛选</h2>
<p>减少共线性较高的预测变量，R2显著提升。</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ PKC + PIK3CA + PDE5 + EDNRB + CYP1A1, 
       data = saponin)
   
   Residuals:
        Min       1Q   Median       3Q      Max 
   -1.61958 -0.40345  0.03593  0.60166  1.00880 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)  -2.3507     3.5738  -0.658 0.524219    
   PKC          -2.4697     0.5838  -4.230 0.001412 ** 
   PIK3CA        2.0240     0.6088   3.324 0.006778 ** 
   PDE5         -1.8261     0.4366  -4.182 0.001530 ** 
   EDNRB         1.9591     0.4185   4.681 0.000671 ***
   CYP1A1        0.8466     0.6461   1.310 0.216795    
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 0.9304 on 11 degrees of freedom
   Multiple R-squared:  0.7884, Adjusted R-squared:  0.6922 
   F-statistic: 8.195 on 5 and 11 DF,  p-value: 0.001914</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_final, <span class="at">newdata =</span> saponin)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 MSE: 0.560112328519279"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 AIC:"</span>, <span class="fu">AIC</span>(model_final)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 AIC: 52.3904053406138"</code></pre>
</div>
</div>
</section>
<section id="岭回归-2" class="level2">
<h2 class="anchored" data-anchor-id="岭回归-2">岭回归</h2>
<section id="绘制岭回归的残差图" class="level3">
<h3 class="anchored" data-anchor-id="绘制岭回归的残差图">绘制岭回归的残差图</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ridge_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge, <span class="at">s =</span> <span class="fl">0.06</span>, <span class="at">newx =</span> x) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="岭回归的r2值和均方误差mse-1" class="level3">
<h3 class="anchored" data-anchor-id="岭回归的r2值和均方误差mse-1">岭回归的R2值和均方误差(MSE)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">R2_mse</span>(saponin,ridge,<span class="fl">0.06</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mean Squared Error (MSE): 0.5072452 
   R Squared (rsq): 0.8083448</code></pre>
</div>
</div>
</section>
<section id="方程各系数-2" class="level3">
<h3 class="anchored" data-anchor-id="方程各系数-2">方程各系数</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   14 x 1 sparse Matrix of class "dgCMatrix"
                        s1
   (Intercept) -5.80016357
   AKT1         0.15246982
   PKC         -2.27542860
   PIK3CA       1.80981631
   PDE5        -1.45483710
   AMPK        -0.36769201
   eNOS        -0.04041883
   SIRT1        0.08215439
   PDK1         0.30011879
   PRKG1       -0.26699522
   APLNR        0.77257334
   TGR5         0.22078822
   EDNRB        1.40263720
   CYP1A1       0.40334906</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="生物碱alkaloids" class="level1">
<h1>生物碱(Alkaloids)</h1>
<section id="全部变量线性回归-1" class="level2">
<h2 class="anchored" data-anchor-id="全部变量线性回归-1">全部变量线性回归</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(easystats)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model <span class="ot">&lt;-</span> <span class="fu">lm</span>(log10ec50 <span class="sc">~</span>.<span class="sc">-</span>ec50,<span class="at">data =</span> Alkaloids)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   <span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ . - ec50, data = Alkaloids)
   
   Residuals:
          1        2        3        4        5        6        7        8 
   -0.22870 -0.05617  0.08248  0.00418  0.23730  0.77080  0.16152 -0.03024 
          9       10       11       12       13       14       15       16 
   -0.27326 -0.09633  0.91456 -0.71988  0.02231 -0.03806  0.09489 -0.65962 
         17       18       19 
   -0.22768  0.12982 -0.08790 
   
   Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)   
   (Intercept)  8.979773   1.768127   5.079  0.00384 **
   AKT1        -1.405575   0.541231  -2.597  0.04843 * 
   PKC         -0.493047   0.394269  -1.251  0.26644   
   PIK3CA       1.710560   0.910508   1.879  0.11908   
   PDE5        -0.262127   0.509827  -0.514  0.62906   
   AMPK         5.054500   1.221126   4.139  0.00900 **
   eNOS         1.994357   0.825621   2.416  0.06045 . 
   SIRT1       -1.682406   0.747363  -2.251  0.07417 . 
   PDK1        -2.437268   0.873204  -2.791  0.03839 * 
   PRKG1        0.001883   0.441152   0.004  0.99676   
   APLNR       -2.021380   0.560771  -3.605  0.01547 * 
   TGR5        -3.580033   0.807179  -4.435  0.00679 **
   EDNRB        3.054451   0.973256   3.138  0.02571 * 
   CYP1A1      -0.585859   0.216382  -2.708  0.04240 * 
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 0.735 on 5 degrees of freedom
   Multiple R-squared:  0.9346, Adjusted R-squared:  0.7646 
   F-statistic: 5.498 on 13 and 5 DF,  p-value: 0.03551</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> Alkaloids[,<span class="dv">15</span>] <span class="sc">|&gt;</span><span class="fu">as.matrix</span>()</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> Alkaloids[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">14</span>)] <span class="sc">|&gt;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">as.matrix</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># 预测</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> Alkaloids)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression MSE: 0.142146566757345"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression AIC:"</span>, <span class="fu">AIC</span>(model)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression AIC: 46.8526289866258"</code></pre>
</div>
</div>
</section>
<section id="最优子集法筛选模型-2" class="level2">
<h2 class="anchored" data-anchor-id="最优子集法筛选模型-2">最优子集法筛选模型</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model_final <span class="ot">&lt;-</span> model<span class="sc">|&gt;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select_parameters</span>() </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(model_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ AKT1 + PKC + PIK3CA + AMPK + eNOS + 
       SIRT1 + PDK1 + APLNR + TGR5 + EDNRB + CYP1A1, data = Alkaloids)
   
   Residuals:
        Min       1Q   Median       3Q      Max 
   -0.71649 -0.18286 -0.02158  0.10397  0.89768 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)   9.3125     1.2875   7.233 0.000172 ***
   AKT1         -1.4368     0.4664  -3.081 0.017793 *  
   PKC          -0.4251     0.3221  -1.320 0.228400    
   PIK3CA        1.6697     0.7791   2.143 0.069307 .  
   AMPK          5.3204     0.9535   5.580 0.000833 ***
   eNOS          2.0715     0.6891   3.006 0.019777 *  
   SIRT1        -1.9127     0.5186  -3.688 0.007773 ** 
   PDK1         -2.7201     0.5867  -4.636 0.002380 ** 
   APLNR        -2.1900     0.3618  -6.052 0.000515 ***
   TGR5         -3.6477     0.6793  -5.370 0.001041 ** 
   EDNRB         3.2365     0.7558   4.282 0.003646 ** 
   CYP1A1       -0.6385     0.1637  -3.901 0.005890 ** 
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 0.6374 on 7 degrees of freedom
   Multiple R-squared:  0.9312, Adjusted R-squared:  0.823 
   F-statistic: 8.606 on 11 and 7 DF,  p-value: 0.004433</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_final, <span class="at">newdata =</span> Alkaloids)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 MSE: 0.149676023017795"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 AIC:"</span>, <span class="fu">AIC</span>(model_final)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 AIC: 43.8333030837152"</code></pre>
</div>
</div>
</section>
<section id="模型诊断-1" class="level2">
<h2 class="anchored" data-anchor-id="模型诊断-1">模型诊断</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(YangPac)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ModelDiagnose</span>(model_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "------------------正态性检验--------------------"
   OK: residuals appear as normally distributed (p = 0.813).
   
   [1] "-----------异方差性（方差齐性）检验---------------"
   OK: Error variance appears to be homoscedastic (p = 0.715).
   
   [1] "----------------自相关性检验--------------------"
   OK: Residuals appear to be independent and not autocorrelated (p = 0.658).
   
   [1] "-----------多重共线性性检验---------------"
   # Check for Multicollinearity
   
   Low Correlation
   
      Term  VIF      VIF 95% CI Increased SE Tolerance Tolerance 95% CI
      AKT1 4.56 [ 3.63,   5.81]         2.13      0.22     [0.17, 0.28]
    CYP1A1 3.64 [ 2.93,   4.61]         1.91      0.27     [0.22, 0.34]
   
   Moderate Correlation
   
    Term  VIF      VIF 95% CI Increased SE Tolerance Tolerance 95% CI
     PKC 7.39 [ 5.81,   9.50]         2.72      0.14     [0.11, 0.17]
   
   High Correlation
   
      Term   VIF      VIF 95% CI Increased SE Tolerance Tolerance 95% CI
    PIK3CA 31.12 [24.03,  40.41]         5.58      0.03     [0.02, 0.04]
      AMPK 87.23 [67.11, 113.49]         9.34      0.01     [0.01, 0.01]
      eNOS 34.93 [26.95,  45.37]         5.91      0.03     [0.02, 0.04]
     SIRT1 29.42 [22.72,  38.19]         5.42      0.03     [0.03, 0.04]
      PDK1 32.51 [25.09,  42.21]         5.70      0.03     [0.02, 0.04]
     APLNR 10.02 [ 7.82,  12.92]         3.16      0.10     [0.08, 0.13]
      TGR5 44.60 [34.37,  57.96]         6.68      0.02     [0.02, 0.03]
     EDNRB 36.15 [27.89,  46.96]         6.01      0.03     [0.02, 0.04]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="岭回归-3" class="level2">
<h2 class="anchored" data-anchor-id="岭回归-3">岭回归</h2>
<section id="方程各系数-3" class="level3">
<h3 class="anchored" data-anchor-id="方程各系数-3">方程各系数</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   14 x 1 sparse Matrix of class "dgCMatrix"
                         s1
   (Intercept)  6.435581710
   AKT1        -0.540288095
   PKC         -0.458524565
   PIK3CA       0.669129083
   PDE5        -0.536427507
   AMPK         0.505480672
   eNOS         0.343311284
   SIRT1       -0.006730424
   PDK1        -0.076345041
   PRKG1        0.417289584
   APLNR       -0.522959611
   TGR5        -0.350342785
   EDNRB       -0.085139571
   CYP1A1      -0.082836867</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ridge.y<span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge,<span class="at">newx=</span>x,<span class="at">s=</span><span class="fl">0.09</span>,<span class="at">type =</span> <span class="st">"response"</span>) </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(ridge.y,y,<span class="at">xlab=</span><span class="st">"Predicted"</span>,<span class="at">ylab =</span> <span class="st">"Actual"</span>,<span class="at">main =</span> <span class="st">"Ridge Regression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="岭回归的r2值和均方误差mse-2" class="level3">
<h3 class="anchored" data-anchor-id="岭回归的r2值和均方误差mse-2">岭回归的R2值和均方误差(MSE)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">R2_mse</span>(saponin,ridge,<span class="fl">0.06</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mean Squared Error (MSE): 7.314633 
   R Squared (rsq): -1.763727</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="酚类phenols" class="level1">
<h1>酚类(Phenols)</h1>
<section id="全部变量线性回归-2" class="level2">
<h2 class="anchored" data-anchor-id="全部变量线性回归-2">全部变量线性回归</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(easystats)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model <span class="ot">&lt;-</span> <span class="fu">lm</span>(log10ec50 <span class="sc">~</span>.<span class="sc">-</span>ec50,<span class="at">data =</span> Phenols)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   <span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ . - ec50, data = Phenols)
   
   Residuals:
        Min       1Q   Median       3Q      Max 
   -1.55554 -0.33751  0.06419  0.40981  1.44722 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)  
   (Intercept)  6.95623    2.74716   2.532   0.0215 *
   AKT1         0.19426    0.46694   0.416   0.6826  
   PKC          0.19205    1.05198   0.183   0.8573  
   PIK3CA       0.76591    0.37047   2.067   0.0543 .
   PDE5        -0.08661    0.93411  -0.093   0.9272  
   AMPK        -1.29362    1.18806  -1.089   0.2914  
   eNOS        -0.41441    0.31157  -1.330   0.2011  
   SIRT1        0.47075    0.73481   0.641   0.5303  
   PDK1         0.03435    0.28716   0.120   0.9062  
   PRKG1        0.63178    0.90657   0.697   0.4953  
   APLNR        0.57676    0.88004   0.655   0.5210  
   TGR5         0.18157    0.76449   0.238   0.8151  
   EDNRB       -1.41274    0.50769  -2.783   0.0128 *
   CYP1A1      -0.56269    0.33189  -1.695   0.1082  
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 0.8919 on 17 degrees of freedom
   Multiple R-squared:  0.776,  Adjusted R-squared:  0.6048 
   F-statistic: 4.531 on 13 and 17 DF,  p-value: 0.002243</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> Phenols[,<span class="dv">15</span>] <span class="sc">|&gt;</span><span class="fu">as.matrix</span>()</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> Phenols[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">14</span>)] <span class="sc">|&gt;</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">as.matrix</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># 预测</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> Phenols)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression MSE: 0.436262622034652"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression AIC:"</span>, <span class="fu">AIC</span>(model)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression AIC: 92.2593520002365"</code></pre>
</div>
</div>
</section>
<section id="最优子集法筛选模型-3" class="level2">
<h2 class="anchored" data-anchor-id="最优子集法筛选模型-3">最优子集法筛选模型</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model_final <span class="ot">&lt;-</span> model<span class="sc">|&gt;</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select_parameters</span>() </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(model_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ PIK3CA + AMPK + eNOS + PRKG1 + EDNRB + 
       CYP1A1, data = Phenols)
   
   Residuals:
       Min      1Q  Median      3Q     Max 
   -1.7548 -0.4704  0.1094  0.5838  1.2678 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)   7.6888     1.6200   4.746 7.92e-05 ***
   PIK3CA        1.0418     0.2509   4.152 0.000359 ***
   AMPK         -0.5965     0.3646  -1.636 0.114855    
   eNOS         -0.3157     0.1869  -1.689 0.104077    
   PRKG1         0.7528     0.5022   1.499 0.146878    
   EDNRB        -1.0890     0.3137  -3.472 0.001975 ** 
   CYP1A1       -0.5733     0.1605  -3.573 0.001538 ** 
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 0.8017 on 24 degrees of freedom
   Multiple R-squared:  0.7446, Adjusted R-squared:  0.6807 
   F-statistic: 11.66 on 6 and 24 DF,  p-value: 4.103e-06</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_final, <span class="at">newdata =</span> Phenols)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 MSE: 0.497575759203293"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 AIC:"</span>, <span class="fu">AIC</span>(model_final)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 AIC: 82.3359579793805"</code></pre>
</div>
</div>
</section>
<section id="模型诊断-2" class="level2">
<h2 class="anchored" data-anchor-id="模型诊断-2">模型诊断</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ModelDiagnose</span>(model_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "------------------正态性检验--------------------"
   OK: residuals appear as normally distributed (p = 0.320).
   
   [1] "-----------异方差性（方差齐性）检验---------------"
   OK: Error variance appears to be homoscedastic (p = 0.095).
   
   [1] "----------------自相关性检验--------------------"
   OK: Residuals appear to be independent and not autocorrelated (p = 0.576).
   
   [1] "-----------多重共线性性检验---------------"
   # Check for Multicollinearity
   
   Low Correlation
   
      Term  VIF    VIF 95% CI Increased SE Tolerance Tolerance 95% CI
    PIK3CA 4.42 [2.93,  7.05]         2.10      0.23     [0.14, 0.34]
      eNOS 3.11 [2.14,  4.91]         1.76      0.32     [0.20, 0.47]
    CYP1A1 2.59 [1.83,  4.07]         1.61      0.39     [0.25, 0.55]
   
   Moderate Correlation
   
     Term  VIF    VIF 95% CI Increased SE Tolerance Tolerance 95% CI
     AMPK 8.81 [5.59, 14.29]         2.97      0.11     [0.07, 0.18]
    PRKG1 6.50 [4.19, 10.47]         2.55      0.15     [0.10, 0.24]
    EDNRB 9.05 [5.74, 14.68]         3.01      0.11     [0.07, 0.17]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="岭回归-4" class="level2">
<h2 class="anchored" data-anchor-id="岭回归-4">岭回归</h2>
<section id="方程各系数-4" class="level3">
<h3 class="anchored" data-anchor-id="方程各系数-4">方程各系数</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   14 x 1 sparse Matrix of class "dgCMatrix"
                        s1
   (Intercept)  7.12931973
   AKT1         0.26253932
   PKC         -0.15700302
   PIK3CA       0.57004454
   PDE5        -0.20227936
   AMPK        -0.40062493
   eNOS        -0.10801234
   SIRT1        0.14769923
   PDK1        -0.03027368
   PRKG1        0.01921076
   APLNR       -0.05202150
   TGR5         0.15570623
   EDNRB       -0.60463582
   CYP1A1      -0.30786379</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ridge.y<span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge,<span class="at">newx=</span>x,<span class="at">s=</span><span class="fl">0.08</span>,<span class="at">type =</span> <span class="st">"response"</span>) </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(ridge.y,y,<span class="at">xlab=</span><span class="st">"Predicted"</span>,<span class="at">ylab =</span> <span class="st">"Actual"</span>,<span class="at">main =</span> <span class="st">"Ridge Regression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="岭回归的r2值和均方误差mse-3" class="level3">
<h3 class="anchored" data-anchor-id="岭回归的r2值和均方误差mse-3">岭回归的R2值和均方误差(MSE)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">R2_mse</span>(saponin,ridge,<span class="fl">0.06</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mean Squared Error (MSE): 2.998338 
   R Squared (rsq): -0.1328781</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="萜类terpenes" class="level1">
<h1>萜类(Terpenes)</h1>
<section id="全部变量线性回归-3" class="level2">
<h2 class="anchored" data-anchor-id="全部变量线性回归-3">全部变量线性回归</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(easystats)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model <span class="ot">&lt;-</span> <span class="fu">lm</span>(log10ec50 <span class="sc">~</span>.<span class="sc">-</span>ec50,<span class="at">data =</span> Terpenes)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   <span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ . - ec50, data = Terpenes)
   
   Residuals:
        Min       1Q   Median       3Q      Max 
   -1.11342 -0.30168 -0.03678  0.39141  1.23530 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)  
   (Intercept)  6.42265    3.15097   2.038    0.072 .
   AKT1         0.43593    1.04047   0.419    0.685  
   PKC          0.37031    0.58965   0.628    0.546  
   PIK3CA      -0.79807    0.74685  -1.069    0.313  
   PDE5        -0.10249    0.67879  -0.151    0.883  
   AMPK         0.21174    0.79779   0.265    0.797  
   eNOS        -0.13011    0.67498  -0.193    0.851  
   SIRT1       -0.16271    0.64037  -0.254    0.805  
   PDK1        -0.74526    1.03781  -0.718    0.491  
   PRKG1        0.32773    0.90067   0.364    0.724  
   APLNR        0.06236    0.58584   0.106    0.918  
   TGR5         0.42533    0.30342   1.402    0.195  
   EDNRB       -0.65244    0.89666  -0.728    0.485  
   CYP1A1       0.23733    0.19546   1.214    0.256  
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 0.8641 on 9 degrees of freedom
   Multiple R-squared:  0.7616, Adjusted R-squared:  0.4172 
   F-statistic: 2.212 on 13 and 9 DF,  p-value: 0.1182</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> Terpenes[,<span class="dv">15</span>] <span class="sc">|&gt;</span><span class="fu">as.matrix</span>()</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> Terpenes[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">14</span>)] <span class="sc">|&gt;</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">as.matrix</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># 预测</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> Terpenes)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression MSE: 0.292204688288982"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression AIC:"</span>, <span class="fu">AIC</span>(model)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression AIC: 66.9742556224229"</code></pre>
</div>
</div>
</section>
<section id="最优子集法筛选模型-4" class="level2">
<h2 class="anchored" data-anchor-id="最优子集法筛选模型-4">最优子集法筛选模型</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model_final <span class="ot">&lt;-</span> model<span class="sc">|&gt;</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select_parameters</span>() </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(model_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ PIK3CA + TGR5 + EDNRB + CYP1A1, data = Terpenes)
   
   Residuals:
        Min       1Q   Median       3Q      Max 
   -1.14232 -0.33739 -0.04902  0.51403  1.17568 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)  7.81045    1.27160   6.142 8.43e-06 ***
   PIK3CA      -0.60720    0.37963  -1.599  0.12713    
   TGR5         0.56378    0.15831   3.561  0.00223 ** 
   EDNRB       -1.05849    0.27446  -3.857  0.00116 ** 
   CYP1A1       0.15564    0.09034   1.723  0.10205    
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 0.6769 on 18 degrees of freedom
   Multiple R-squared:  0.7074, Adjusted R-squared:  0.6424 
   F-statistic: 10.88 on 4 and 18 DF,  p-value: 0.0001158</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_final, <span class="at">newdata =</span> Terpenes)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 MSE: 0.358619673022883"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 AIC:"</span>, <span class="fu">AIC</span>(model_final)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 AIC: 53.6848367777012"</code></pre>
</div>
</div>
</section>
<section id="模型诊断-3" class="level2">
<h2 class="anchored" data-anchor-id="模型诊断-3">模型诊断</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(YangPac)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ModelDiagnose</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "------------------正态性检验--------------------"
   OK: residuals appear as normally distributed (p = 0.897).
   
   [1] "-----------异方差性（方差齐性）检验---------------"
   OK: Error variance appears to be homoscedastic (p = 0.455).
   
   [1] "----------------自相关性检验--------------------"
   OK: Residuals appear to be independent and not autocorrelated (p = 0.474).
   
   [1] "-----------多重共线性性检验---------------"
   # Check for Multicollinearity
   
   Low Correlation
   
      Term  VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI
    CYP1A1 3.28 [ 2.64,  4.16]         1.81      0.30     [0.24, 0.38]
   
   Moderate Correlation
   
    Term  VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI
     PKC 8.90 [ 6.94, 11.50]         2.98      0.11     [0.09, 0.14]
    TGR5 7.75 [ 6.06,  9.99]         2.78      0.13     [0.10, 0.16]
   
   High Correlation
   
      Term   VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI
      AKT1 21.04 [16.23, 27.37]         4.59      0.05     [0.04, 0.06]
    PIK3CA 13.36 [10.36, 17.33]         3.66      0.07     [0.06, 0.10]
      PDE5 13.23 [10.26, 17.16]         3.64      0.08     [0.06, 0.10]
      AMPK 18.91 [14.60, 24.59]         4.35      0.05     [0.04, 0.07]
      eNOS 27.75 [21.37, 36.13]         5.27      0.04     [0.03, 0.05]
     SIRT1 14.87 [11.51, 19.30]         3.86      0.07     [0.05, 0.09]
      PDK1 38.34 [29.47, 49.97]         6.19      0.03     [0.02, 0.03]
     PRKG1 23.59 [18.19, 30.70]         4.86      0.04     [0.03, 0.05]
     APLNR 10.97 [ 8.52, 14.20]         3.31      0.09     [0.07, 0.12]
     EDNRB 26.12 [20.12, 34.00]         5.11      0.04     [0.03, 0.05]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ModelDiagnose</span>(model_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "------------------正态性检验--------------------"
   OK: residuals appear as normally distributed (p = 0.546).
   
   [1] "-----------异方差性（方差齐性）检验---------------"
   OK: Error variance appears to be homoscedastic (p = 0.602).
   
   [1] "----------------自相关性检验--------------------"
   OK: Residuals appear to be independent and not autocorrelated (p = 0.934).
   
   [1] "-----------多重共线性性检验---------------"
   # Check for Multicollinearity
   
   Low Correlation
   
      Term  VIF   VIF 95% CI Increased SE Tolerance Tolerance 95% CI
      TGR5 3.44 [2.23, 5.84]         1.85      0.29     [0.17, 0.45]
     EDNRB 3.99 [2.54, 6.80]         2.00      0.25     [0.15, 0.39]
    CYP1A1 1.14 [1.01, 2.86]         1.07      0.88     [0.35, 0.99]
   
   Moderate Correlation
   
      Term  VIF   VIF 95% CI Increased SE Tolerance Tolerance 95% CI
    PIK3CA 5.63 [3.46, 9.69]         2.37      0.18     [0.10, 0.29]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-79-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="岭回归-5" class="level2">
<h2 class="anchored" data-anchor-id="岭回归-5">岭回归</h2>
<section id="方程各系数-5" class="level3">
<h3 class="anchored" data-anchor-id="方程各系数-5">方程各系数</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   14 x 1 sparse Matrix of class "dgCMatrix"
                        s1
   (Intercept)  6.20296901
   AKT1        -0.02653323
   PKC          0.20890259
   PIK3CA      -0.35666282
   PDE5        -0.26533342
   AMPK         0.27227387
   eNOS        -0.15341890
   SIRT1       -0.24715257
   PDK1        -0.27831593
   PRKG1        0.15715467
   APLNR        0.04133084
   TGR5         0.32892301
   EDNRB       -0.46921138
   CYP1A1       0.14785399</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ridge.y<span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge,<span class="at">newx=</span>x,<span class="at">s=</span><span class="fl">0.08</span>,<span class="at">type =</span> <span class="st">"response"</span>) </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(ridge.y,y,<span class="at">xlab=</span><span class="st">"Predicted"</span>,<span class="at">ylab =</span> <span class="st">"Actual"</span>,<span class="at">main =</span> <span class="st">"Ridge Regression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="岭回归的r2值和均方误差mse-4" class="level3">
<h3 class="anchored" data-anchor-id="岭回归的r2值和均方误差mse-4">岭回归的R2值和均方误差(MSE)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">R2_mse</span>(saponin,ridge,<span class="fl">0.06</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mean Squared Error (MSE): 6.537455 
   R Squared (rsq): -1.470082</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="苯丙素类ppp" class="level1">
<h1>苯丙素类(PPP)</h1>
<section id="全部变量线性回归-4" class="level2">
<h2 class="anchored" data-anchor-id="全部变量线性回归-4">全部变量线性回归</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(easystats)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model <span class="ot">&lt;-</span> <span class="fu">lm</span>(log10ec50 <span class="sc">~</span>.<span class="sc">-</span>ec50,<span class="at">data =</span> PPP)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   <span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ . - ec50, data = PPP)
   
   Residuals:
          1        2        3        4        5        6        7        8 
    0.09947 -0.01529 -0.04740  0.10067 -0.15370  0.25298  0.05560 -0.11079 
          9       10       11       12       13       14       15       16 
    0.17997 -0.08865  0.02891 -0.04551 -0.01297  0.32123 -0.37153 -0.19300 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
   (Intercept)  8.62118    3.87907   2.222    0.156
   AKT1        -0.11377    0.82150  -0.138    0.903
   PKC          1.67834    0.87016   1.929    0.194
   PIK3CA       0.78843    0.34309   2.298    0.148
   PDE5         1.37764    2.09019   0.659    0.578
   AMPK        -1.10888    1.14738  -0.966    0.436
   eNOS        -1.25976    1.14771  -1.098    0.387
   SIRT1        0.78556    1.24443   0.631    0.592
   PDK1        -0.54365    0.87779  -0.619    0.599
   PRKG1       -0.67026    0.55429  -1.209    0.350
   APLNR       -1.61286    1.53617  -1.050    0.404
   TGR5        -0.07792    0.68401  -0.114    0.920
   EDNRB       -0.12536    0.96921  -0.129    0.909
   CYP1A1      -0.34871    0.37482  -0.930    0.450
   
   Residual standard error: 0.4729 on 2 degrees of freedom
   Multiple R-squared:  0.9764, Adjusted R-squared:  0.823 
   F-statistic: 6.364 on 13 and 2 DF,  p-value: 0.1438</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> PPP[,<span class="dv">15</span>] <span class="sc">|&gt;</span><span class="fu">as.matrix</span>()</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> PPP[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">14</span>)] <span class="sc">|&gt;</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">as.matrix</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># 预测</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> PPP)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression MSE: 0.0279559949980445"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Linear Regression AIC:"</span>, <span class="fu">AIC</span>(model)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "Linear Regression AIC: 18.1720552659144"</code></pre>
</div>
</div>
</section>
<section id="最优子集法筛选模型-5" class="level2">
<h2 class="anchored" data-anchor-id="最优子集法筛选模型-5">最优子集法筛选模型</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> model_final <span class="ot">&lt;-</span> model<span class="sc">|&gt;</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select_parameters</span>() </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(model_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
   Call:
   lm(formula = log10ec50 ~ PKC + PIK3CA + PDE5 + AMPK + eNOS + 
       SIRT1 + PDK1 + PRKG1 + APLNR + CYP1A1, data = PPP)
   
   Residuals:
          1        2        3        4        5        6        7        8 
    0.13619 -0.06556 -0.03404  0.12401 -0.20851  0.28587  0.07262 -0.12616 
          9       10       11       12       13       14       15       16 
    0.20872 -0.08635  0.05405 -0.04728 -0.05811  0.25824 -0.36115 -0.15256 
   
   Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)   8.3875     0.9888   8.483 0.000374 ***
   PKC           1.6333     0.3221   5.071 0.003862 ** 
   PIK3CA        0.7545     0.1684   4.481 0.006512 ** 
   PDE5          1.1619     0.4240   2.740 0.040794 *  
   AMPK         -1.1067     0.3483  -3.178 0.024605 *  
   eNOS         -1.1325     0.4150  -2.729 0.041347 *  
   SIRT1         0.8679     0.4094   2.120 0.087485 .  
   PDK1         -0.6640     0.3459  -1.920 0.112934    
   PRKG1        -0.7592     0.2690  -2.823 0.036986 *  
   APLNR        -1.5906     0.3948  -4.029 0.010031 *  
   CYP1A1       -0.3229     0.1148  -2.813 0.037398 *  
   ---
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
   
   Residual standard error: 0.3052 on 5 degrees of freedom
   Multiple R-squared:  0.9754, Adjusted R-squared:  0.9263 
   F-statistic: 19.84 on 10 and 5 DF,  p-value: 0.00207</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_final, <span class="at">newdata =</span> PPP)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># 计算MSE</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 MSE:"</span>, mse_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 MSE: 0.0291077727762431"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"最优子集模型 AIC:"</span>, <span class="fu">AIC</span>(model_final)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "最优子集模型 AIC: 12.818032506418"</code></pre>
</div>
</div>
</section>
<section id="模型诊断-4" class="level2">
<h2 class="anchored" data-anchor-id="模型诊断-4">模型诊断</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ModelDiagnose</span>(model_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "------------------正态性检验--------------------"
   OK: residuals appear as normally distributed (p = 0.629).
   
   [1] "-----------异方差性（方差齐性）检验---------------"
   OK: Error variance appears to be homoscedastic (p = 0.497).
   
   [1] "----------------自相关性检验--------------------"
   OK: Residuals appear to be independent and not autocorrelated (p = 0.128).
   
   [1] "-----------多重共线性性检验---------------"
   # Check for Multicollinearity
   
   Low Correlation
   
      Term  VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI
    PIK3CA 4.11 [ 3.40,  5.04]         2.03      0.24     [0.20, 0.29]
    CYP1A1 4.64 [ 3.82,  5.71]         2.15      0.22     [0.18, 0.26]
   
   Moderate Correlation
   
     Term  VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI
    PRKG1 7.27 [ 5.92,  9.00]         2.70      0.14     [0.11, 0.17]
   
   High Correlation
   
     Term   VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI
      PKC 16.01 [12.90, 19.95]         4.00      0.06     [0.05, 0.08]
     PDE5 43.44 [34.79, 54.31]         6.59      0.02     [0.02, 0.03]
     AMPK 15.02 [12.10, 18.70]         3.88      0.07     [0.05, 0.08]
     eNOS 26.80 [21.51, 33.46]         5.18      0.04     [0.03, 0.05]
    SIRT1 27.60 [22.14, 34.46]         5.25      0.04     [0.03, 0.05]
     PDK1 24.50 [19.67, 30.58]         4.95      0.04     [0.03, 0.05]
    APLNR 16.74 [13.47, 20.85]         4.09      0.06     [0.05, 0.07]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="岭回归-6" class="level2">
<h2 class="anchored" data-anchor-id="岭回归-6">岭回归</h2>
<section id="方程各系数-6" class="level3">
<h3 class="anchored" data-anchor-id="方程各系数-6">方程各系数</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   14 x 1 sparse Matrix of class "dgCMatrix"
                         s1
   (Intercept)  6.479651909
   AKT1         0.197872284
   PKC          0.786253229
   PIK3CA       0.655306427
   PDE5        -0.007733551
   AMPK        -0.495885362
   eNOS        -0.386107774
   SIRT1        0.649148347
   PDK1        -0.215970674
   PRKG1       -0.936822245
   APLNR       -0.281275576
   TGR5        -0.163466739
   EDNRB       -0.226227772
   CYP1A1      -0.332733627</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ridge.y<span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge,<span class="at">newx=</span>x,<span class="at">s=</span><span class="fl">0.06</span>,<span class="at">type =</span> <span class="st">"response"</span>) </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(ridge.y,y,<span class="at">xlab=</span><span class="st">"Predicted"</span>,<span class="at">ylab =</span> <span class="st">"Actual"</span>,<span class="at">main =</span> <span class="st">"Ridge Regression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="线性回归模型_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="岭回归的r2值和均方误差mse-5" class="level3">
<h3 class="anchored" data-anchor-id="岭回归的r2值和均方误差mse-5">岭回归的R2值和均方误差(MSE)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">R2_mse</span>(saponin,ridge,<span class="fl">0.06</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mean Squared Error (MSE): 3.929984 
   R Squared (rsq): -0.4848868</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="预测新值" class="level1">
<h1>预测新值</h1>
<p>收集新的皂苷类数据，预测log10ec50值，最后s1列为岭回归的预测结果。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(readxl)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> saponin_predict <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"D:</span><span class="sc">\\</span><span class="st">Rstudio</span><span class="sc">\\</span><span class="st">Rmyfile</span><span class="sc">\\</span><span class="st">Traditional Chinese Medicine</span><span class="sc">\\</span><span class="st">saponin_predict.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> saponin_predict <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(saponin_predict)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ridge.predict <span class="ot">&lt;-</span><span class="fu">predict</span>(ridge,<span class="at">s=</span><span class="fl">0.06</span>,<span class="at">newx =</span> saponin_predict,<span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> saponin_predict <span class="ot">&lt;-</span> <span class="fu">cbind</span>(saponin_predict,ridge.predict)   </span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> saponin_predict <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(saponin_predict)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> saponin_predict</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       AKT1   PKC PIK3CA   PDE5  AMPK   eNOS  SIRT1   PDK1 PRKG1 APLNR   TGR5
   1  6.424 6.614  7.097  7.281 6.842  8.382  9.071  9.389 6.621 8.378  9.819
   2  6.011 7.090  8.292  7.698 7.315  8.657  8.577  8.510 5.853 7.970 10.230
   3  6.813 8.053  7.801  7.934 8.173  8.941  9.495  7.825 7.023 8.769 11.610
   4  7.175 8.321  8.779  9.425 7.740  8.979 10.100  9.953 6.538 8.339  8.475
   5  8.062 8.287  8.182 10.020 8.877  9.484  9.528  8.675 8.009 9.847 11.060
   6  6.363 7.806  8.643  9.697 8.199  7.697 10.110  9.069 6.513 8.612  9.989
   7  8.419 8.704  9.008  9.603 8.724  7.956 10.050  9.180 8.361 9.794 10.390
   8  6.837 8.150  7.390  8.777 7.014  9.031  8.712  7.067 5.963 9.107  8.775
   9  5.322 7.661  7.627  9.415 8.457  8.093  9.913  9.835 7.579 9.096 10.160
   10 7.391 8.654  8.530  8.080 8.128  8.726  9.201  9.353 6.922 8.635 10.310
   11 6.429 7.272  7.288  8.382 6.967  8.820  9.097  8.178 5.906 8.310  9.676
   12 6.420 7.681  8.412  8.463 6.865  9.279  8.753  8.145 6.811 8.598  8.885
   13 6.103 8.687  8.424  9.338 8.135  9.017  9.977 10.730 8.271 8.678 11.110
   14 7.812 8.811  9.576 10.170 9.178  9.002 10.890  9.652 8.274 9.485 10.280
   15 8.024 8.715  8.903  9.477 9.497 10.440 10.030  9.711 7.947 9.155  9.148
   16 6.943 8.340  7.953  8.822 7.949  8.780  9.947  7.764 6.622 9.856  9.381
   17 6.250 7.023  7.579  8.566 7.372  8.551  8.340  6.940 5.682 8.106  7.997
       EDNRB CYP1A1         s1
   1   8.453  6.803  0.4367400
   2   8.055  5.919  2.1887974
   3   8.543  6.179  1.2464909
   4   8.886  6.966  3.0397089
   5   9.927  6.698 -0.4325599
   6   8.326  7.283  2.5680341
   7  10.140  7.340  0.9389569
   8   9.555  6.411  2.3023121
   9   9.823  6.619 -0.2701916
   10  8.520  6.631  2.0940882
   11  8.286  5.889  2.1732793
   12  9.259  6.441  1.6828730
   13  8.926  6.702  0.3543886
   14  9.932  7.559  1.2457382
   15  8.979  7.320  0.3714492
   16 10.540  6.344  1.9980477
   17  8.310  5.603  2.4417716</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/github\.com\/chase-maker");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../TCM/contents2.html" class="pagination-link" aria-label="天然血管保护剂的理论预测">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">天然血管保护剂的理论预测</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../TCM/连续型机器学习模型.html" class="pagination-link" aria-label="连续型机器学习模型">
        <span class="nav-page-text">连续型机器学习模型</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© created by Wencan Yang; December 2024</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chase-maker/edit/main/TCM/线性回归模型.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chase-maker/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with ❤️ and [github][quarto].</p>
</div>
  </div>
</footer>




</body></html>